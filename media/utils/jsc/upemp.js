var cntEmb,session=dat[0],orgMsg=dat[1],msgJOB={1:function(e){var t=new FormData;const n={tmpfiles_org:function(){return t.append("file",e.bl,e.na),msgJOB.__rst=function(e){return JSON.parse(e).data.url.replace("tmpfiles.org","tmpfiles.org/dl/")},"https://tmpfiles.org/api/v1/upload"},fakeapi_platzi_com:function(){return t.append("file",e.bl,e.na),msgJOB.__rst=function(e){return JSON.parse(e).location},"https://api.escuelajs.co/api/v1/files/upload"},convertapi_com:function(){return t.append("file",e.bl,e.na),msgJOB.__rst=function(e){return JSON.parse(e).Url},"https://v2.convertapi.com/upload"},litterbox_catbox_moe:function(){return t.append("fileToUpload",e.bl,e.na),t.append("time","1h"),t.append("reqtype","fileupload"),msgJOB.__rst=function(e){return e},"https://litterbox.catbox.moe/resources/internals/api.php"},y_dnd_vn:function(){const n=[[["0x0.st","file","expires","1"],function(e){return e},0],[["uguu.se/upload","files[]"],function(e){return e.files[0].url},0],[["bashupload.com","file","json","true"],function(e){return e.file.url},1]],o=[],s=function(){const e=n.filter(function(e){return 1==e[2]});for(var t=e.length;0!==t;){let n=Math.floor(Math.random()*t);t--,[e[t],e[n]]=[e[n],e[t]]}return e.reduce(function(e,t){return e[t[0][0]]=t[1],o.push(t[0]),e},{})}();msgJOB.__rst=function(e){const t=JSON.parse(e);return("err"==t[0]?t[1]:s[t[0]](t[1])).replace(/[\r\n]/g,"")};const i=JSON.stringify(o);return t.append("api",i),t.append("file",e.bl,e.na),"https://y.dnd.vn/uploadfile?fuk="+encodeURIComponent(btoa(i))}},o=new XMLHttpRequest;o.open("POST",n[msgJOB[1].__err||"convertapi_com"](),!0),o.onerror=function(){console.error("Network error occurred.")},o.ontimeout=function(){console.error("Request timed out.")},(null!=o.upload?o.upload:o).onprogress=function(e){window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:e.type,prog:[e.loaded,e.total]}},orgMsg)},o.send(t),o.onreadystatechange=function(){if(4==this.readyState){var t=window.location.href,n=window.location.pathname;t=t.split(n)[0];var s=window.location.pathname.split("/");if(s[s.length-1]="upemp/"+this.responseText,console.log(this.responseText),chkFN.vF=encodeURIComponent(t+s.join("/")),o.status>=200&&o.status<300)chkFN.vF=encodeURIComponent(msgJOB.__rst(this.responseText));else{if(!msgJOB[1].__err)return msgJOB[1].__err="fakeapi_platzi_com",void msgJOB[1](e);chkFN.vF=encodeURIComponent("https://hrm.dnd.vn/fake_err.xls"),console.error("Server error:",o.status,o.statusText)}return window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:1,na:this.responseText}},orgMsg),console.log(chkFN.vF),void chkFN.click()}}},10:function(e){cntEmb="_self",window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:1,na:e.bl}},orgMsg),chkFN.vF=encodeURIComponent(e.bl),chkFN.click()}},livRMV=[],lop=3,liveHWND=0,startEMB=0,chkFN=document.getElementById("test_msg");function embbed(){cntEmb=null;var e=this.fi,t=this.na;_iframeUrl=["https://PSG3-excel.officeapps.live.com/x/_layouts/xlembed.aspx?ui=en%2DUS&rs=en%2DUS&WOPISrc=http%3A%2F%2Fpsg3%2Dview%2Dwopi%2Ewopi%2Eonline%2Eoffice%2Enet%3A808%2Foh%2Fwopi%2Ffiles%2F%40%2FwFileId%3FwFileId%3D",e,"&access_token_ttl=0&hid="+(new Date).getTime()],console.log(_iframeUrl);var n=document.createElement("iframe");function o(e){clearTimeout(liveHWND),console.log("working:",(new Date).getTime()-startEMB),n.style.display="","_blank"==this?(window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:2,na:"rawlive"}},orgMsg),livRMV=[n,form2],cntEmb?setTimeout(function(){cntEmb()},100):cntEmb="_self"):window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:3,na:"working"}},orgMsg)}function s(e,t,n){var o=document.createElement("form");o.action=e,o.method="post",o.target="wacframe"+n,o.id="form2"+n;var i=document.createElement("input");i.type="hidden",i.name="access_token",i.value=t,o.appendChild(i),document.body.appendChild(o),startEMB=(new Date).getTime(),s.frmHTML=o.outerHTML,o.submit()}function i(){if(clearTimeout(liveHWND),window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:4,na:"fail"}},orgMsg),--lop>0){n.onload=null,n.contentWindow.document.open(),n.contentWindow.document.write(s.frmHTML),n.contentWindow.document.close(),n.onload=o.bind(t);var e=n.contentWindow.document.getElementsByTagName("form")[0];_iframeUrl[1]="https%3A%2F%2Fhellohrm.github.io%2Futils%2Fmedia%2Futils%2Ftmplexcel%2Fmisa_baocao_chamcong.xlsx",e.setAttribute("action",decodeURIComponent(_iframeUrl.join(""))),liveHWND=setTimeout(function(){i()},6e4),document.createElement("form").submit.call(e)}}n.src="",n.frameBorder=0,n.id="wacframe"+t,n.name="wacframe"+t,n.setAttribute("allowfullscreen","true"),document.body.appendChild(n),n.onload=o.bind(t),s(decodeURIComponent(_iframeUrl.join("")),"1",t),liveHWND=setTimeout(function(){i()},6e4)}function clearFRM(){var e=document.getElementsByTagName("iframe");e.length>0&&(e=e[0]).parentNode.removeChild(e)}function hwndMsg(e){const t=parseInt(e.data.k);if([1,10].indexOf(t)>-1)return msgJOB[t]&&msgJOB[e.data.k](e.data.dat),void(cntEmb="_self");if(2!=t){if(3==t)return clearFRM(),void(embbed._bklive&&embbed.bind(embbed._bklive)());var n;n="https://robertnyman.com"!==e.origin?"You are not worthy":"I got "+e.data+" from "+e.origin,document.getElementById("received-message").innerHTML=n+(new Date).getTime()}else clearFRM()}chkFN.addEventListener("click",function(){const e=decodeURIComponent(this.vF);cntEmb?setTimeout(function(){embbed._bklive={fi:encodeURIComponent(e),na:"_file"},embbed.bind(embbed._bklive)()},100):cntEmb=embbed.bind({fi:encodeURIComponent(e),na:"_file"})}),window.addEventListener?window.addEventListener("message",hwndMsg,!1):window.attachEvent("onmessage",hwndMsg),setTimeout(function(){window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:0}},orgMsg)},100);