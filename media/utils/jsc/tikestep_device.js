_o$h.hasOwnProperty("tikestep_device")||(_o$h.tikestep_device=function(e){"use strict";function t(e,t,n){const o=e.ua>1?"UA":"noU",i=this,a=function(){function e(e){if(e){var t=e.getContext("2d");t.font="20px Arial",t.fillStyle="#444444";for(var n=20,o=Math.floor(e.width/n),i=Math.floor(e.height/n),a=["0","1"],s=[],r=n,l=n,c=0;c<i;c++)for(var d=0;d<o;d++)s.push({x:d*l,y:c*r,value:a[Math.floor(Math.random()*a.length)],hasDrawn:!1});var u,f,p=100,m=Date.now();s.forEach((function(e){t.clearRect(e.x,e.y,l,r),t.fillText(e.value,e.x,e.y+r),e.hasDrawn=!0}));var v=function(){window.requestAnimationFrame(v),u=Date.now(),(f=u-m)>p&&(s.forEach((function(e){if(!0===e.hasDrawn&&100*Math.random()>95){var n=e.value===a[1]?a[0]:a[1];t.clearRect(e.x,e.y,l,r),t.fillText(n,e.x,e.y+r),e.value=n}})),m=u-f%p)};v()}}return{draw:e}}();var s,r,l,c,d,u,f=0,p=null,m=!1,v=function(){m=!1,S();var e=c.find(".dog_canvas");e.html("<canvas></canvas>"),a.draw(e.find("canvas")[0]),c.find(".mt-3").html(U[6][0]),z.btnOK.option({visible:!0,disabled:!1}),z.btnCANCEL[0].option("disabled",!1),A(2,0),A(3,0),J.next().removeClass().addClass("text-success"),g._lastMSG=-1},g=function(e){m=!0,g._lastMSG!=e&&(S(),J.next().removeClass().addClass("text-warning"),A(2,1),z.btnOK.option("visible",!1),z.btnCANCEL[0].option("disabled",!1),c.find(".mt-3").html(U[6][e][0]),J.addClass("timeout"),s=1,x=new Date,M(0,U[6][e]),g._lastMSG=e)},h={},_=function(){clearTimeout(_.hwndTimeout);const e=this[0],t=this[1];for(var n in h)h.hasOwnProperty(n)&&h[n](e,n,t)},b=function(e){return btoa(window[st0("1")](e.replace(/\"/g,"").replace(/,/g,"").slice(1,-1)))},D=function(e,t,n){return e&&t.forEach((function(o,i){-1==n.indexOf(i)&&o==e[1][i]&&(t[i]=-111111111)})),t},w=$.Deferred(),C=$.Deferred(),y=function(e){z.btnCANCEL[0].option("disabled",!0),z.btnOK.option("disabled",!0),clearTimeout(_.hwndTimeout),w.reject(),C.reject(),w=$.Deferred(),C=$.Deferred();var t=z.btnOK.__k,o=Math.random().toString(36).slice(2,10)+(new Date).getTime(),i=function(i,a,s){if(i[0][1]==a[1]&&-9999==a[1]){var r=[-1];switch(a[2]){case 1:c.find(".mt-3").html(s[6]);break;case 10001:r[0]=1,r[1]=JSON.parse(s[6]);break;case 50:r[0]=2,r[1]=s[6]}if(r[0]>-1&&(n.WDM[t[0]].wdms[R("serno","value")][r[0]]=r[1]),0==a[0])return clearTimeout(_.hwndTimeout),delete h[o],e?3:2}return 0},a=t&&t.length>2&&t[2].split("\n"),s=[1,-9999,JSON.stringify([(new Date).getTime()]),t[3],D(n.WDM[t[0]].wdms[R("serno","value")],[R("rtevt","value")?1:0,R("timezone","selectedItem").tim,R("timezone","value"),R("isatt","value")?1:0,0],[1,2])],l=["DeviceName"],u=function(){if(!m)if(a.length>0){var e=apisvr.a$.trim(a.shift());"~"==e.substring(0,1)?(d.WriteLn({type:"input",prompt:" ▲ ",value:e,typeDelay:10},(function(e){u()})),l.forEach((function(n){var o=e.split(n+"=");2==o.length&&"~"==o[0]&&(t[4][n]=o[1])}))):u()}else w.resolve("info")};h[o]=function(o,a,s){var r=0;if(0==s){var l=this;(t[1]==o[2]||e)&&(r=i(l,o[3],o[4]))}else r=1,m=!0,w.reject("info"),I(U[7][s],"text-danger",2,!0),z.btnOK.option("visible",!1);if(r>0){if(delete h[a],2==r){C.resolve(o[5]);var c=n.WDM[t[0]].auth;return c.statux=1,void n.WDM[t[0]].setAUTH(c)}3==r&&(w.resolve(""),C.resolve(o[5])),z.btnCANCEL[0].option("disabled",!1),z.btnOK.option("disabled",!1)}}.bind([s]),$.when(w,C).done((function(e,o){r.isSAVE=1,r.saveDB(n.WDM[t[0]].wdms,o),r.hide()})),w.promise(),C.promise(),_.hwndTimeout=setTimeout((function(){_.bind([null,3])()}),25e3),t[4]={},e?e(o):(n.WDM[t[0]].emit(n.___[1],[[t[1]],s]),u())},E=function(e,t,o,i){if(e){var a=atob(e).split(String.fromCharCode(4)),s="localconn"!=a[a.length-1]?b(a[1]):(gloEVTs.giaidoan2_localDEV("disconn",[a[a.length-2],a[0],[,,["del",o,i[0]]]]),"return");if("return"==s)return"localconn";if(n.WDM[s]){var r=n.WDM[s].DEVs.indexOf(a[0]),l=["0","1"];if(1===t&&(n.WDM[s].wdms.hasOwnProperty(o)&&(l=[o,n.WDM[s].wdms[o][0]]),n.WDM[s].emit(n.___[2],[a[0],0,l]),console.log([a[0],0,l])),r>-1){var c=n.WDM[s].DEVs.splice(r,1);c.length>0&&(n.WDM[s].auth.sn!=o||n.WDM[s].auth.sn==o&&0!=n.WDM[s].auth.statux||a[0]!=n.WDM[s].auth.token)&&gloEVTs.dumeTHIETBI.f1.bind(["offline",c[0],,,["del"].concat(l)])()}0==n.WDM[s].DEVs.length?setTimeout((function(){n.WDM[s].off("disconnect").close([1]),delete n.WDM[s]}),1===t?1e3:1):1===t&&(n.WDM[s].auth={token:n.WDM[s].DEVs[0],statux:1})}}},T=function(e){var o,i=e.length>4,a=i&&"wdmso"==e[4][0]?(o=e[4][4],e[4][3]):[];return"kickoff"==e[0]||"usr"==e[0]?n.fnHANDSHAKE([e[0],[e[1]],e[0],e[3],a,o]):["online","offline"].indexOf(e[0])>-1?(n.fnHANDSHAKE(["sigLIVE",[e[1]],e[0],e[3],a,o],e),"cntU"!==e[3]&&gloEVTs.dumeTHIETBI.f1.bind(e)()):e[3]&&e[3]===n.___[0]&&t.trigger(e[3]+"S",[e[4].split("\t")]),i||a.length>0},O=function(){if(!this||!this[0])return;var e=this,o=atob(e[0]).split(String.fromCharCode(4)),i="localconn"!=o[o.length-1]?b(o[1]):(gloEVTs.giaidoan2_localDEV("connect",[[o[o.length-2],"0",e[2]],e[0],e[4],function(e){p&&"function"==typeof p&&p(["connect"])}]),"return"),a={token:o[0],statux:e[1],id:e[2],sn:e[3]},s=function(){n.WDM[i].on("connect",(function(e){if(p&&"function"==typeof p)p(["connect"]);else{n.WDM[i].auth;var o,a=n.WDM[i].sockAUT();n.WDM[i].DEVs.forEach((function(e){e!=a.token&&(o||(o=t.find(".mcc-statux")),o.map((function(t,o){var a=$(o);if(a.attr("tok")==e){var s=a.data(e);n.WDM[i].emit(n.___[2],[e,1,1,s[2],s[3]])}})),console.log("if (dev != elUI.WDM[__k].auth.token) {"))}))}f>0&&v()})).on("connect_error",(function(e){console.log("connect_to_wdms_server connect_error");var t=!1,o=0,a="eeeeeeee",s=e.message&&e.message.split(a)||[];2==s.length&&""==s[0]&&"disconnect"==(a=JSON.parse(s[1]))[0]&&(o=a[1],s=a[2],t=!0),p&&"function"==typeof p&&p(["connect_error",t]),f>0&&(t?I(U[2][o],"text-danger",s):g(1)),n.WDM[i].DEVs&&"offline"!=n.fnHANDSHAKE.currMSG&&n.WDM[i].DEVs.forEach((function(e){n.fnHANDSHAKE(["sigLIVE",[e],"offline",0,[]])}))})).on("reconnect",(function(e){console.log("connect_to_wdms_server reconnect")})).on("disconnect",(function(e,t){console.log("connect_to_wdms_server disconnect"),n.WDM[i].DEVs&&n.WDM[i].DEVs.forEach((function(e){n.fnHANDSHAKE(["sigLIVE",[e],"offline",0,[]])}))})).on("DEV_MSG",(function(e){"RST_CMD"==e[0]?_.bind([e,e[1]])():(f>0&&("online"==e[0]?v():g(2)),T(e)&&"wdmso"==e[4][0]&&(console.log("new wdmso"+(new Date).getTime()+JSON.stringify(e[4][3])),this.wdms[e[4][1]]=[e[4][2],e[4][3],e[4][4],e[4][5]]))}),"RTEVT").STARTd()};if("return"==i)return console.log(o[o.length-2]),[i,e[0]];const r=sockjo.getSOCK(i);if(n.hasOwnProperty("onlyDEV_ATT_EVT")||(n.WDM[i]=r),n.WDM[i]){if(n.hasOwnProperty("onlyDEV_ATT_EVT"));else{var l=!1;n.WDM[i].hasOwnProperty("instance")&&(n.WDM[i]=n.WDM[i].instance,s(),l=n.WDM[i].DEVs.indexOf(o[0])>-1),n.WDM[i].auth=a,n.WDM[i].emit(n.___[2],[o[0],1,e[1],e[2],e[3]]),l&&-1!=n.WDM[i].DEVs.indexOf(o[0])||n.WDM[i].DEVs.push(o[0])}p&&"function"==typeof p&&p([n.___[2]])}else{var c=JSON.parse(o[1]).reduce((function(e,t){return e+String.fromCharCode(parseInt(t,16))}),""),d=window.location.protocol;d=d.indexOf("file:")>-1?1===window.debuglocal?"http:":"https:":d,n.WDM[i]=new JO(d+"//"+(d.indexOf("https")>-1?c.split(":")[0]:c),{auth:a,transports:["websocket","polling"]},[i]),s(),n.WDM[i].auth=a,n.WDM[i].DEVs=[o[0]]}return[i,o[0]]},x=new Date,M=function(e,t,n){if(s>0){clearTimeout(s);var o=e-parseInt(((new Date).getTime()-x.getTime())/1e3);e>0&&o<=0?G():(e>0?o+=t[0]:(o=Math.abs(o)+" seconds passed",n=t[Math.abs(e)],e-=1,Math.abs(e)>t.length-1&&(e=0)),d.WriteLn({type:"input",prompt:" ⏳ "+o,value:n,typeDelay:30},(function(o){-2!=s&&(s=setTimeout((function(){M(e,t,n)}),2e3))})))}},S=function(){J.empty(),clearTimeout(s),s=-2,J.removeClass("timeout")},k=function(e,t,o,i){n.WDM[e].DEVs.indexOf(t[0]);var a=Math.random().toString(36).slice(2,10)+(new Date).getTime(),s=setTimeout((function(){_.bind([[,,t[0]],3])()}),-505==o[1]?3e4:8e3);h[a]=function(t,o,a){const s=this,r=function(e){clearTimeout(s[2]),delete h[o]};s[1]==t[2]&&(0==a?0==t[3][0]?(r(),i("OK",t,o)):10001==t[3][2]&&n.WDM[e].wdms[doD.serno]&&(n.WDM[e].wdms[doD.serno][1]=JSON.parse(t[4][6])):(r(),toastMsg(U[8][3]+"("+a+")","error"),i("ERR",[,,,[0]],o)))}.bind([o,t[0],s]),n.WDM[e].emit(n.___[1],[[t[0]],o])},V=function(e,t){t=t.concat([e[2],e[3]]),e&&"function"==typeof e[4]?(t.push(e[5]),e[4](t)):($(e[0].target).trigger("rst_devstas",t),toastMsg(U[8][4],"success"))},N=n._cmddev=function(){var e,t=this,o=t[1],i=t[2].tok,a=[o,"RocX8fPu8CM6HymwUub1GqCoxKq/8pGJ7csvzNk/LWrHqUSLrDhZaRnTtMK5mROQ7wCsEG+4qDZSzWEPuyR0YpkilgEl9Uc5UwMprTL+gUeNKpnmqcvY9zDYB8/4UUuqc35j9UYYlQ8pDyoQRJ6nul/4nbcxMiGxfVjlkWEjhK6cOTrwaVxu39PXfo9NAFEyqycLreXqK+ApT5xRuZ0Xsw==",t[5]||"0|100|0|$!N;$!N;$!N;|0|2"],s=atob(i).split(String.fromCharCode(4)),r="localconn"!=s[s.length-1]?b(s[1]):(e=[[s[s.length-2]],i,a,function(e,n){V(t,[e,[n,,,["localconn",a[0],a[2]]]]),srclocked(!1)}],gloEVTs.giaidoan2_localDEV("devcmd",e),"return");"return"!=r&&n.WDM[r]&&k(r,s,-505==o?(a.unshift(t[0]),a):[1,o,"tinhsau"],(function(e,n,o){try{0==n[3][0]&&V(t,[e,n])}catch(e){}finally{srclocked(!1)}}))},A=function(e,t){U.$regstep=e;for(var n=c.find(".wdms-regstep span.btn"),o=0;o<n.length;o++){var i=$(n[o]),a=i.next();if(a.removeAttr("class").html("<small>"+a.text()+"</small>"),o<=e)if(o<e)i.removeAttr("disabled").removeClass("btn-default btn-warning").addClass("btn-success"),i.text("✔"),a.text(a.text()),a.addClass("text-success");else{var s="btn-success";t>0&&(s="btn-warning",a.text(a.text()).addClass("text-warning")),i.removeAttr("disabled").removeClass("btn-default").addClass(s),c.find(".text_conn").text(a.text())}else i.attr("disabled","disabled").removeClass("btn-success").addClass("btn-default")}n.closest(".wdms-regstep").css("display","")},W=function(e,t,n){z.btnCANCEL[0].option({icon:z.btnCANCEL[e],text:z.btnCANCEL[t]}),z.btnCANCEL.act=n},I=function(e,t,n,o){(U[4][0]!=n||o)&&(U[4][0]=n,c.empty(),S(),c.append([J,$("<div>"+U[0].replace("$TIT$",U[4][n])+'<div class="mt-3 text-center"><i class="fa fa-quote-left" aria-hidden="true"></i> '+e+' <i class="fa fa-quote-right" aria-hidden="true"></div></div>')]),J.next().addClass(t),3==n?W(3,4,1):W(1,2,2))},L=function(){I(U[3],"text-success",3),S(),J.addClass("timeout"),s=1,x=new Date,M(120,[U[6][5]],U[6][6])},P=function(e){var t=/^(http|https):\/\/[^:\/]+(?::(\d+))?/,o=(e=l.getEditor("wdms").option("value")).match(t),i=document.createElement("a"),a=function(){return e=i.pathname.split("/"),{auth:{token:"token-secure-socket",ireg:{sn:R("serno","value"),pkey:R("pkey","value"),tz:R("timezone","selectedItem").tim,rtevt:R("rtevt","value")?1:0,grp:e[e.length-1],tep:0}},transports:["websocket","polling"]}};null===o&&(e=window.location.protocol.indexOf("file:")>-1&&1===window.debuglocal?window.location.protocol+"////"+e:window.location.protocol+"//"+e),i.href=e,n.socIO&&n.socIO.off();var s=i.protocol.indexOf("file:")>-1?"wss://":"";s=s+i.hostname+(""!=s||i.protocol.indexOf("https")>-1?"":":11015"),1===window.debuglocal&&window.location.protocol.indexOf("file:")>-1&&(s="ws://"+l.getEditor("wdms").option("value").split(":")[0]+":11015"),n.socIO=io(s,a()),n.socIO.on("connect",(function(e){L()})).on("connect_error",(function(e){var t=0,n="eeeeeeee",o=e.message&&e.message.split(n)||[];2==o.length&&""==o[0]&&"disconnect"==(n=JSON.parse(o[1]))[0]&&(t=n[1],o=n[2]),I(U[2][t],"text-danger",o)})).on("reconnect",(function(e){})).on("disconnect",(function(e,t){I(U[2][0],"text-danger",2),console.log("elUI.socIO.on('disconnect', (reason): "+e)})).on("reg_wdms",(function(e){if("begincmd"==(e=JSON.parse(e))[0])S(),d.WriteLn({type:"input",prompt:" ▲ ",value:"We are checking your WDMS device, please wait a moment ...",typeDelay:20},(function(t){if(0==U.$regstep){var n,o=$('<span class="progress"></span>');o.appendTo(J),n=o.innerWidth(),U.$pCHAR=[$('<span class="progress-bar" style="width:'+.2*n+'px; position: absolute; white-space: nowrap; transition: none 0s ease 0s;">20%</span>').appendTo(o),e[1],n]}})),A(0,0);else if("handshakecmd"==e[0]){var t=U.$pCHAR;if(t){var o=e[1]/t[1],i=parseInt(100*o),a=o*t[2];t[0].width(a>t[2]?t[2]:a).text((i>100?100:i)+"%")}}else if("handshakeend"==e[0])"CHK::OK"!=e[1]?(console.log("reg_check_err"),I(U[5][0],"text-danger",4),A(0,1)):(S(),d.WriteLn({type:"input",prompt:" ▲ ",value:U[5][1],typeDelay:20},(function(e){})),A(1,0));else if("activeend"==e[0])"WDMS::OK"!=e[1]?(console.log(e[1]),I(U[5][2]+e[1],"text-danger",4),A(1,1)):(S(),d.WriteLn({type:"input",prompt:" ▲ ",value:U[5][3],typeDelay:20},(function(e){})),A(2,0));else if("regresult"==e[0])if(""!=e[1]){this.auth.ireg.tep=-9999;var s=l.option("formData");s.tok=e[1],e[4]&&(s.fcmk=e[4]),g._lastMSG=-1,f=1,z.btnOK.__k=O.bind([e[1],0,s.id,s.serno,[X(s)]])(),z.btnOK.__k.push(e[2]),z.btnOK.__k.push(e[3]),W(1,2,2),n.socIO.off("connect").off("disconnect").off("connect_error").off("reg_wdms")}else I(U[5][2],"text-danger",4),A(2,1);$(".sockmsg").text(e)}))},K=function(){c.html(""),l.option({readOnly:!1,disabled:!1}),z.btnWDMS.option("visible",!0),z.btnCLOSE.option("disabled",!1),z.btnCANCEL[0].option("disabled",!1),z.btnOK.option("disabled",!1),z.btnOK.option("visible",!1),z.btnOK.__k=null,l._$element.removeClass("opac2"),W(1,2,0),r.preventCANCEL_AGAIN=0,U[4][0]=0},j=function(e,t){n.dogTimezone[0].visible=!0;var o=!1;if(t>-1&&e)for(var i in n.WDM)if(n.WDM.hasOwnProperty(i)){var a=n.WDM[i].wdms;a.hasOwnProperty(e.serno)&&(o=!0,t=a[e.serno][1],e.rtevt=1==t[0],e.time_zone=t[1],e.timezone=t[2],e.isatt=1==t[3],2e3!=t[1]&&(n.dogTimezone[0].visible=!1))}o||(e.rtevt=!0,e.time_zone=2e3,e.timezone=2e3,e.isatt=!0),l&&R("timezone","dataSource",n.dogTimezone)},R=function(e,t,n){var o=l.getEditor(e);if(void 0===n)return o.option(t);o.option(t,n)},z={btnCANCEL:[null,"revert",n.lan.js_009_19||"Cancel","ti ti-unlink",n.lan.js_009_20||"Stop MOBI","tips","Hoan tat"]},J=$('<div class="more-link"></div>'),U=['<div class="wdms-regstep text-small" style="display:none;"><div> <span class="btn btn-sm btn-default">1</span><p><small>Check</small></p></div><div>     <span class="btn btn-sm btn-default">2</span>    <p><small>Active</small></p></div><div>    <span class="btn btn-sm btn-default">3</span>    <p><small>Online</small></p></div></div><div><div class="dog_canvas"></div><div class="box_conn"><div class="text_conn text-uppercase">$TIT$</div><div class="comp"></div><div class="loader_conn"></div><div class="con"></div><div class="byte"></div><div class="server"></div></div></div>',"Connect to Mobi service ...",["Connect error, please check WDMS or IP address and try again  ...","Token invalid for connection!","There is another Active your device."],(n.lan.js_009_21||"Please enter server Mobi into device")+'. <a href="javascript:void(0)">'+(n.lan.js_009_22||"Click here for a help")+" </a>",[0,"CONNECTING","ERROR","CONNECTED","UNSUPPORTED","INVALID","DUPLICATED"],["Sorry, our service have not yet support your device ...","Congratulation your device passed our check! Next step we establish WDMS cloud for your device, keep patient ....","Device actived error: ","Device try connecting to our WDMS server ..."],["Complete by click OK button",["Opps! Mobi service down...","Please check Device network connection...","Please check Device IP, DNS, Gateway...","... Try more please !"],["Humm! We are looking for your device...","Please check Device network connection...","Please check Device IP, DNS, Gateway..."],"<i>"+(n.lan.js_009_23||"Please confirm you want to skip MOBI activation")+" ?</i>","<i>"+(n.lan.js_009_24||"Please confirm that you want to remove the device")+" ?</i>"," seconds next expired","Is your device ready ...?"],["","Standalone command timeout","Can not find MOTER","Mobi service timeout","Can not find your Device"],n.lan.js_009_25||["<i>Please confirm save changes ?</i>","Opps! no changes for updating.","The device is offline, it can not be updated !","An error occurred during the update, please try again.","Update successful"]],B=$('<div class="fuck-title text-center text-uppercase ">Activate Mobi function</div>'),F=function(e,t){DevExpress.ui.dialog.confirm(e,null,!1).done((function(e){t(e)}))},H=function(e){var t,n=z.btnUPT.option("visible");["ten","serno","wdms","pkey"].indexOf(e.dataField)>-1&&(t=apisvr.a$.trim(e.value),e.component.getEditor(e.dataField).option({value:t})),n&&(z.btnUPT.option("disabled",!1),r._cpFieldChanged[0][e.dataField]=t||e.value),r.isSAVE=1};function G(e){S();var t=function(){o();var e=l.option("formData");E(e.tok,1,e.serno),!e.tok&&n.localDEV&&gloEVTs.elUI_localDEV("disconn",[e.wdms]),K(),r.preventCANCEL_AGAIN=1,r.hide()},o=function(){var e=0;return 0!=z.btnCANCEL.act&&n.socIO&&(n.socIO.close(),e=1),K(),1==e};e?z.btnOK.__k?z.btnOK.option("visible")?F(U[6][3],(function(e){e&&t()})):t():o()||(r.preventCANCEL_AGAIN=1,r.hide()):o()}function q(e,t,n){var o=l.getEditor(e),i=o.option("value"),a=o._$element.data("dxValidator"),s=a&&a._getValidationRules()[0],r=100;if(s)return n&&(null==i||""===apisvr.a$.trim(i.toString())?r=0:n.forEach((function(t){t[e]==i&&(r=1)}))),r<100?(s.message=t[r],s.isValid=!1,o.focus()):(s.message="",s.isValid=!0),a.validate(),r}function X(e){return JSON.stringify([e.rtevt?1:0,e.time_zone,e.timezone,e.isatt?1:0,0])}function Z(e){var t=ee.kind,o=this[0],i=this[1];if(0==t[0]){if(q(t[1],["empty serno","duplicated serno"],o)<100)return}else q("wdms",["empty IP","duplicated IP"],o.filter((function(e){return e.kind==t[0]})));q("id",["id empty","id duplicated"],o)<100||q("ten",["ten empty","ten duplicated"],o)<100||(l.validate().isValid?(l.option("readOnly",!0),z.btnWDMS.option("visible",!1),z.btnCLOSE.option("disabled",!0),I(U[1],"",1),l._$element.addClass("opac2"),setTimeout((function(){var e=function(){var e=l.option("formData");if(101==i)return gloEVTs.giaidoan2_localDEV("connect",[[e.wdms,"0",e.id],null,[X(e),,e.pkey]]);0==t[0]?_gsC(sockjo.soclib,"js",(function(e){P()}),"socket.io.js"):(g._lastMSG=-1,f=1,z.btnOK.__k=O.bind(["STZSZE1FOFo4WmNUVXNId3RwaW5odUE5RlhFL0c1b2p1and6MDVsOHc2ZmJseWp0RFBOZzZHc2Rpb3E2ZWdGVWZWcXkzT2cvak9Eb3pOQ2JMelVKa0QwMitiejJqQS9YeXdZQ2dUN1JjOE09BFsiMzEiLCIzOSIsIjMyIiwiMmUiLCIzMSIsIjM2IiwiMzgiLCIyZSIsIjMxIiwiMmUiLCIzOSIsIjMxIiwiM2EiLCIzMyIsIjMwIiwiMzAiLCIzMCJd",1,0,0,[X(e)]])(),z.btnOK.__k.push("msg[2]"),z.btnOK.__k.push("0"),W(1,2,0))};d?e():_gsC(srcpf$+"/media/js/termynal.js","js",(function(){d=new Termynal(J[0],{cbNewLine:function(){},lineDelay:5}),e()}),"TermynalJS")}),50)):toastMsg(_La$N("js_009_25|5",n.lan)||"Require to fill information","error",null,"top center"))}function Q(e,n){var o=this[0],i=this[1];if(f=0,1==r.isSAVE&&o&&"function"==typeof o){r.isSAVE=0;var a=l.option("formData"),s=[];if(a.time_zone=R("timezone","selectedItem").tim,a.wdmo=JSON.stringify([]),e){var c=R("serno","value");e.hasOwnProperty(c)&&(a.wdmo=JSON.stringify(e[c]),s=["wdmso",c,e[c][0],e[c][1],e[c][2]])}if(-1===i){var d=z.btnOK.__k,u=d[4],p=d[1],m=a.tok;for(var v in m||(a.tok=p,m=p),u)u.hasOwnProperty(v)&&a.hasOwnProperty(v)&&(a[v]=u[v]);o(a),t.find('.mcc-statux[tok="'+m+'"]').attr("tok",p).data(p,[p,1,a.id,a.serno]),T(["online",p,[],n,s]),console.log("dosave")}else o(a,i);R.__doD=a,0==a.kind&&gloEVTs.elUI_localDEV&&gloEVTs.elUI_localDEV("fcmdev",[a,"3"])}}function Y(){var e=function(){r.preventCANCEL_AGAIN=1,r.hide(),srclocked(!1)};if(1==r.isSAVE){var t=r._cpFieldChanged[1],o=r._cpFieldChanged[0],i=[];for(var a in o)o.hasOwnProperty(a)&&t.hasOwnProperty(a)&&o[a]!=t[a]&&i.push(a);if(i.length>0)return void F(U[8][0],(function(t){if(t){srclocked(!0),z.btnCLOSE.option("disabled",!0),z.btnCANCEL[0].option("disabled",!0),z.btnUPT.option("disabled",!0);var o=l.option("formData"),i=(o.time_zone=R("timezone","selectedItem").tim,o.tok),a=atob(i).split(String.fromCharCode(4)),s="localconn"!=a[a.length-1]?b(a[1]):(function(){const t=X(o);gloEVTs.giaidoan2_localDEV("edit",[[a[a.length-2],"0",o.id],i,[t,,o.pkey],function(t,n){n||((n={})[o.serno]=JSON.parse(o.wdmo)),r.saveDB(n),toastMsg(U[8][4],"success"),e(),gloEVTs.giaidoan2_localDEV("fcmdev",[o,"33"])}])}(),"return");if("return"!=s)if(n.WDM[s]){n.WDM[s].DEVs.indexOf(a[0]);var c=Math.random().toString(36).slice(2,10)+(new Date).getTime(),d=function(){clearTimeout(_.hwndTimeout),delete h[c]},u=[1,-9998,D(n.WDM[s].wdms[R("serno","value")],[o.rtevt?1:0,o.time_zone,o.timezone,o.isatt?1:0,0],[])];h[c]=function(t,i,a){0==a?0==t[3][0]?(d(),toastMsg(U[8][4],"success"),r.saveDB(n.WDM[s].wdms),e()):10001==t[3][2]&&n.WDM[s].wdms[o.serno]&&(n.WDM[s].wdms[o.serno][1]=JSON.parse(t[4][6])):(d(),toastMsg(U[8][3]+"("+a+")","error"),e())}.bind([u]),_.hwndTimeout=setTimeout((function(){_.bind([null,3])()}),8e3),n.WDM[s].emit(n.___[1],[[a[0]],u])}else toastMsg(U[8][2],"error"),e()}}));toastMsg(U[8][1],"warning")}e()}const ee=function(e){return"serno"},te=function(e){return"Serial number"},ne=function(e){return 0==e?"Mobi server":"IP Address"},oe=function(e){return _La$N("js_009_18|"+(0==e?e:1),n.lan)||(0==e?"Start MOBI":"Connect")},ie=function(e){return 0==e?[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}},{type:"required"}]:[]};if(this._Device=function(e,o,i,a,s){u=null,j(e.dat,a);const d=function(e){const t=l.getEditor("txt1");t&&t._$element[(0==(ee.kind?ee.kind[0]:s)?"remove":"add")+"Class"]("d-none d-sm-block"),"-1"==a&&(t.option("value","5418212160193"),l.getEditor("wdms").option("value","wdms.dnd.vn:16868/xyz")),srclocked(!1)},f=function(e){1!=r.preventCANCEL_AGAIN&&G(),window.cdv_jsex&&e.component._$popupContent.trigger("cdvHidden",[r])},p=function(e){setTimeout((function(){l.updateDimensions()}),200);var t=z.btnUPT.option("visible");l.getEditor("wdms").option("readOnly",t),t||l.getEditor("timezone").option("value",2e3),u=H,window.cdv_jsex&&e.component._$popupContent.trigger("cdvShown",[r])};admin$.DEV((function(){setTimeout((function(){if(r){l.option("formData",e.dat),z.btnWDMS.option({onClick:Z.bind([i,s]),text:oe(s)}),K(),z.btnUPT.option({visible:-1!==a,disabled:!0}),z.btnWDMS.option("visible",-1===a),q("id",["id empty","id trung"],null);var m=ee.kind;m[1]=ee(s),l.itemOption("txt1","dataField",m[1]),l.itemOption("txt1","label",{text:te(s)}),l.itemOption("txt1","validationRules",ie(s)),l.itemOption("wdms","label",{text:ne(s)}),l.getEditor("txt1").option({disabled:0!=s}),m[0]=s,q(m[1],0==s?["empty serno","trung serno"]:["empty pubkey","trung pubkey"],null),ee.kind=m,r.option({onShowing:d,onHidden:f,onShown:p})}else r=$("<div></div>").appendTo(t.on("onRemoving",(function(e){r.dispose()}))).dxPopup({contentTemplate:function(t){return l=$("<div class='filter_fucking' style='min-height:50vh'></div>").appendTo(t).dxForm({labelMode:"floating",formData:e.dat,screenByWidth:function(e){return e<400?"xs":e<500?"sm":"md"},colCountByScreen:{md:4,sm:1},items:[{dataField:"wdms",colSpan:2,label:{text:ne(s)},validationRules:[{type:"required",message:_La$N("js_009_25|6",n.lan)||"Require to fill"}]},{name:"txt1",dataField:ee(s),colSpan:2,label:{text:te(s)},editorOptions:{disabled:0!=s,onContentReady:function(e){z.txt1=e.component,ee.kind=[s,ee(s)]}},validationRules:ie(s)},{itemType:"group",colCountByScreen:{sm:4,xs:2},colSpan:4,colCount:4,items:[{dataField:"pkey",label:{text:"Mobi P-key"},validationRules:[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}}]},{dataField:"id",label:{text:"No."},validationRules:[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}}]},{dataField:"ten",colSpan:2,label:{text:n.lan.js_009_17||"Name"},editorOptions:{maxLength:15},validationRules:[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}}]}]},{itemType:"group",caption:n.lan.js_009_4||"Advanced setting",cssClass:"advance-item",colCountByScreen:{md:4,sm:1},colSpan:4,colCount:4,items:[{dataField:"area",colSpan:2,editorOptions:{text:"(Default)",disabled:!0},label:{text:n.lan.js_009_8||"Area"}},{dataField:"timezone",colSpan:2,editorType:"dxSelectBox",editorOptions:{dataSource:n.dogTimezone,displayExpr:"dis",valueExpr:"id"},label:{text:n.lan.js_009_6||"Timezone"}}]},{itemType:"group",colCountByScreen:{sm:4,xs:1},colSpan:4,colCount:4,items:[{dataField:"isatt",colSpan:2,editorType:"dxCheckBox",label:{text:n.lan.js_009_7||"Attendance device"}},{dataField:"rtevt",colSpan:2,editorType:"dxCheckBox",label:{text:n.lan.js_009_5||"Realtime event"}}]}],readOnly:!1,showColonAfterLabel:!0,labelLocation:"left",minColWidth:300,colCount:4,onFieldDataChanged:function(e){u&&"function"==typeof u&&u(e)}}).dxForm("instance"),c=$("<div class='font-italic'></div>").appendTo(t),t},deferRendering:!1,width:"100%",maxWidth:600,height:"auto",fullScreen:"phone"==DevExpress.devices._realDevice.deviceType,showTitle:!0,visible:!1,dragEnabled:!1,showCloseButton:!0,animation:{show:{type:"pop"}},onHidden:f,onShowing:d,onShown:p,onContentReady:function(e){e.component._$wrapper.addClass("tbh-filter-popup keep-def containscroll caidat_push_device"+("phone"==DevExpress.devices._realDevice.deviceType?"":" caidat_push_device_overflow"));var t=e.component._$content;z.btnCLOSE=t.find(".dx-closebutton").dxButton("instance")},toolbarItems:[{html:B,location:"after"},{widget:"dxButton",location:"before",options:{icon:"help",type:"success",stylingMode:"text",onClick:function(e){}}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:z.btnCANCEL[1],elementAttr:{class:"show-orther-more"},text:z.btnCANCEL[2],stylingMode:"outlined",onContentReady:function(e){z.btnCANCEL[0]=e.component,z.btnCANCEL.act=0},onClick:G}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:"globe",elementAttr:{class:"show-orther-more"},text:oe(s),type:"default",stylingMode:"outlined",visible:-1===a,onContentReady:function(e){z.btnWDMS=e.component},onClick:Z.bind([i,s])}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:"ti ti-save",text:"Save",type:"success",stylingMode:"outlined",visible:-1!==a,disabled:!0,onContentReady:function(e){z.btnUPT=e.component},onClick:Y}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:"tips",type:"success",stylingMode:"outlined",text:"OK",visible:!1,onContentReady:function(e){z.btnOK=e.component},onClick:function(e){y()}}}]}).dxPopup("instance");B.html(n.lan.js_009_14),r._cpFieldChanged=[{},JSON.parse(JSON.stringify(e.dat))],r.isSAVE=0,r.show(),r.saveDB=Q.bind([o,a])}),10)}))},this._confirmDEL=function(e,t){admin$.DEV((function(){setTimeout((function(){F(U[6][4],(function(e){t(e,E)})),srclocked(!1)}),10)}))},this._cmddev=function(e,t,n,o,i,a,s,r){i?N.bind([e,t,n,o,i,a,s,r])():admin$.DEV(N.bind([e,t,n,o,i,a,s,r]))},this.wdms_conn=function(e,o,i){gloEVTs.devcnt=o.length;var a=o.length,s=0,r=t.find(".mcc-statux"),l=function(){if(s<a){p=function(e){p=null,"connect_error"==e[0]&&e[1]&&E(o[s].tok,0,""),s+=1,l()};var e=o[s],t=[e.tok,1,e.id,e.serno,[X(e),,e.pkey]],i=O.bind(t)();i&&(r.map((function(n,o){o.getAttribute("tok")===e.tok&&(o.setAttribute("tok",i[1]),$(o).data(i[1],t))})),n.onlyDEV_ATT_EVT&&n.onlyDEV_ATT_EVT.bind([i,e,t])())}};a>0&&l()},n.__.forEach((function(e){t.on(e,i[atob(e)])})),!gloEVTs.giaidoan2||!gloEVTs.devcnt||0==gloEVTs.devcnt){gloEVTs.giaidoan2_localDEV=function(){const e=w0w._cordovaNative,t=(new Date).getTime()+Math.random().toString(36).substring(7),o={};if(e){const i={},a=function(o,a){var s,r=[],l={SND_OK:function(e){},conn_err:function(){I(U[2][0],"text-danger",2),delete i[l.IP],delete l.IP},connect:function(n){if(r=[],l.TOK||z.btnCANCEL[0].option("disabled",!1),"0"==n||n.indexOf("CONN_STA")>0&&n.indexOf("offline")>0)l.TOK||l.conn_err();else{if(n=n.split(";"),!l.TOK){I(U[1],"text-success",3),R("serno","value",n[7]),r.push(n[6]),r.push(JSON.parse(n[4])),s=$.Deferred();var o=setTimeout((function(){s.reject(),l.conn_err()}),1e4);d.WriteLn({type:"input",prompt:" ▲ ",value:"MAC: "+n[6],typeDelay:20},(function(e){d.WriteLn({type:"input",prompt:" ▲ ",value:"SN: "+n[7],typeDelay:20},(function(e){$.when(s).done((function(e){y((function(t){clearTimeout(o),h[t](e,t,0),gloEVTs.giaidoan2_localDEV("fcmdev",[R.__doD,"33"])}))}))}))}));const e=btoa(n[7]+";"+n[6]),t=btoa([n[1],l.IP,"localconn"].join(String.fromCharCode(4)));z.btnOK.__k=[e,t,n[7],"0"]}l.wdmso=["wdmso",n[7],n[6],JSON.parse(n[4]),"",n[5]],e.hieu_comjs(["ATT_DEV_CONN",l.IP,"0",c="online",t,"1","2","3"])}},online:function(e){if(0==(e=e.split(String.fromCharCode(31)))[1].indexOf("RTEVT_STA"))return e[0]="LOCAL_DEV_MSG",void T(e);if(0!=e[1].indexOf("USR_EYE"))if(0!=e[1].indexOf("ATT_LOG"))if(0!=e[1].indexOf("CONN_STA"))if((e=e[1].split(String.fromCharCode(4)))[1]=e[6].split("=")[1],l.TOK)l.wdmso[4]=e[1],a=["online",l.TOK,[],50,l.wdmso],T(a);else{r[2]=e[1];var t=z.btnOK.__k;(d={})[t[2]]=r,n.WDM[t[0]]={wdms:d};var o=[,,,[0,-9999,50],[,,,,,,r[2],,],1];l.IP&&s.resolve(o)}else{var i=e[1].split(String.fromCharCode(4));i.shift();var a=i[1].split(";");if(i[1]=l.TOK?l.TOK:btoa([a[1],l.IP,"localconn"].join(String.fromCharCode(4))),i.push([]),i.push(0),a.length>4&&(i[3]=a[8],i.push(["wdmso",a[7],a[6],JSON.parse(a[4]),a[5]])),["reconnect","edit"].indexOf(c)>-1){var d;if(a.length>4){d={};const e=btoa(a[7]+";"+a[6]);d[a[7]]=[a[6],JSON.parse(a[4]),a[5]],n.WDM[e]={wdms:d}}l.cb&&(l.cb("OK",d),delete l.cb),"offline"!=i[0]&&(c="online",i[0]=c)}T(i)}else l.cb&&(l.cb("OK",e[1].split(String.fromCharCode(4))[1]),delete l.cb);else T(["usr",l.TOK,[],e[1].split(String.fromCharCode(4))[1]])},devcmd:function(e){c="online";var t="OK";if((e=e.split(String.fromCharCode(4)))[1].indexOf("offline")>-1)t="ERR";else{if(e[0].indexOf("ATT_LOG")>-1)return void(l.cb&&(l.cb(t,e[1]),delete l.cb));e[6]=e[6].split("=")[1]}l.cb&&(l.cb(t,[,,,,e]),delete l.cb)}},c="",u=function(n,o){const i=n[0],a=n[2]||[],s=function(e){return a[e]&&a[e].toString()||""};l.IP=i[0],l.TOK=n[1],n[3]&&(l.cb=n[3]),e.hieu_comjs(["ATT_DEV_CONN",i[0],i[1]?i[1]:"0",c=o||(l.TOK?"reconnect":"connect"),t,s(0),s(1),s(2),s(3),s(4),s(5),"",(i[2]||"").toString()])};l.reconnect=l.online,l.edit=l.online,u(o,a),this.rst=function(e,t){"SND_OK"==e?l[e](t):t?u(e,t):l[c](e)}};$.extend(o,{connect:function(e){e[1]||z.btnCANCEL[0].option("disabled",!0),i[e[0][0]]=new a(e)},disconn:function(n){n.length>2&&gloEVTs.dumeTHIETBI.f1.bind(["offline",n[1]].concat(n[2]))(),e.hieu_comjs(["ATT_DEV_CONN",n[0],"0","disconn",t,"1","2","3"]),delete i[n[0]]},devcmd:function(e){i[e[0][0]].rst(e,"devcmd")},edit:function(e){i[e[0][0]].rst(e,"edit")},dispose:function(n){e.hieu_comjs(["ATT_DEV_CONN","","0","dispose",t,"1","2","3"])},fcmdev:function(n){var o=n.splice(0,1),i=JSON.parse(o[0].wdmo),a=o[0].fcmk||"",s="0"==n[0]?n[2]||"2":"tinydb",r="0"==i[1][0]||"0"==i[1][3]?"1":n[0];e.hieu_comjs(["ATT_DEV_CONN",a,r,"fcmdev",t,n[1]||"1",s,n[3]||"3",n[4]||"4",n[5]||"5",n[6]||"6",n[7]||"7",n[8]||"8",n[9]||"9",n[10]||"10"])}}),w0w.dopostqueue[t]=function(e){e=e.split(String.fromCharCode(3)),i.hasOwnProperty(e[0])&&("SND_OK"==e[1]?i[e[0]].rst(e[1],e[2]):i[e[0]].rst(e[1]))}}return gloEVTs.elUI_localDEV=function(e,t){if(o.hasOwnProperty(e))return o[e](t)}}();const e=function(t){var n=$.Deferred();return e.raw?n.resolve():(t.trigger("get",[srcp$f+"/media/utils/device_step2.html"+src$id,function(o){var i=this;t.trigger("",[o,!1,$.Deferred().done((function(){const t=$(adCS(arguments[0],i));for(var o=t.length-1;o>-1;o--)if(t[o].classList&&t[o].classList.contains("device-page__content")){t[o].innerHTML+="<link rel='stylesheet' href='"+srcpf$+"/media/css/bubble_msg_demo.css'/>",e.raw=t[o].outerHTML;break}apisvr.a$.scod(arguments[3].splice(0,1)[0]),e.wokJS=arguments[3],e.wokJS.unshift("_$_ATTLOG_$_".hexEncode()),n.resolve()}))])}]),n)};DEVI__Q.VER[1]=o,gloEVTs.giaidoan2=function(t,o,i,a){const s=function(t){e(i).done((function(a){const s=$(e.raw).on("buoc2_c$b",gloEVTs.cb$STEP2),c=(["JS_JS_payrollonline","attlog_oneday"].indexOf(o)>-1?i:l.find(".modal-body")).append(s).ready((function(t){c.find("[data-lang]").each((function(e,t){var o=t.getAttribute("data-lang");$(t).html(_La$N(o,n.lan))})),Main.hasOwnProperty("device_step2")&&(gloEVTs.giaidoan2.fnXX=new Main.device_step2({el:c,elUI:n,wokJS:e.wokJS,zkblob:r}),gloEVTs.giaidoan2.fnXX.initWOK(i.__dbDAT.filter((function(e){return!0===e.isatt}))))})).on("DOWN_ATTLOG_END",(function(){console.log("DOWN_ATTLOG_END ",(new Date).getTime()),t()}));i$Desk&&["JS_JS_payrollonline","attlog_oneday"].indexOf(o)<0&&(l.log_scrollPerfect||(l.att_scrollPerfect=new PerfectScrollbar(c[0],{suppressScrollX:!0})))}))},r=function(e,t,o,i,a){setTimeout((function(){n[atob("X2NtZGRldg")].bind([a,e,t,o,s,i])()}),100);const s=function(e){const t=e[4].split("|");toastMsg(e[2].ten+" get block "+t[4]+" ~ "+(parseInt(t[1])+parseInt(t[4])),"OK"==e[0]?"success":"error",null,null,"fogetdev"),gloEVTs.giaidoan2.fnXX.bz2(e,r)};console.log("ios",a)};if(["JS_JS_payrollonline","attlog_oneday"].indexOf(o)>-1)return void DEVI__Q(s);const l=admin$.popup.bind().apply(null,[{a:"d",t:o,cBu:1,fw:0,cbClosed:function(e){l.att_scrollPerfect&&l.att_scrollPerfect.destroy(),n.unFixW&&n.unFixW()}}]),c=l.find("#popupdone");return l.find(".modal-dialog").addClass("modal-dialog-centered modal-dialog-zoom pu_fullW my-0").css({"max-width":"800px"}),l.find(".modal-footer").remove(),c.remove(),l[a||"one"]("shown.bs.modal",(function(){DEVI__Q(s)})),setTimeout(DEVI__Q((function(e){l.modal("show"),e()})),1),l}}}return t.prototype.publicSharedVar="quux",t.prototype.publicSharedMethod=function(e){},t}());