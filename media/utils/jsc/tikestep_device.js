_o$h.hasOwnProperty("tikestep_device")||(_o$h.tikestep_device=function(e){"use strict";function t(e,t,n){var o,i=0,s=null,a=!1,r=$.Deferred(),c=$.Deferred(),l=new Date;const d=e.ua>1?"UA":"noU",u=this,f=function(){function e(e){if(!e)return;const t=e.getContext("2d"),n=20,o=Math.floor(e.width/n),i=Math.floor(e.height/n),s=["0","1"],a=[],r=n,c=n;t.font="20px Arial",t.fillStyle="#444444";for(var l=0;l<i;l++)for(var d=0;d<o;d++)a.push({x:d*c,y:l*r,value:s[Math.floor(Math.random()*s.length)],hasDrawn:!1});const u=100;var f,p,m=Date.now();function v(){window.requestAnimationFrame(v),f=Date.now(),(p=f-m)>u&&(a.forEach((function(e){if(!0===e.hasDrawn&&100*Math.random()>95){var n=e.value===s[1]?s[0]:s[1];t.clearRect(e.x,e.y,c,r),t.fillText(n,e.x,e.y+r),e.value=n}})),m=f-p%u)}a.forEach((function(e){t.clearRect(e.x,e.y,c,r),t.fillText(e.value,e.x,e.y+r),e.hasDrawn=!0})),v()}return{draw:e}}(),p=function(){a=!1,y();var e=N.find(".dog_canvas");e.html("<canvas></canvas>"),f.draw(e.find("canvas")[0]),N.find(".mt-3").html(F[6][0]),J.btnOK.option({visible:!0,disabled:!1}),J.btnCANCEL[0].option("disabled",!1),A(2,0),A(3,0),U.next().removeClass().addClass("text-success"),m._lastMSG=-1},m=function(e){a=!0,m._lastMSG!=e&&(y(),U.next().removeClass().addClass("text-warning"),A(2,1),J.btnOK.option("visible",!1),J.btnCANCEL[0].option("disabled",!1),N.find(".mt-3").html(F[6][e][0]),U.addClass("timeout"),o=1,l=new Date,O(0,F[6][e]),m._lastMSG=e)},v={},_=function(){clearTimeout(_.hwndTimeout);const e=this[0],t=this[1];for(var n in v)v.hasOwnProperty(n)&&v[n](e,n,t)},g=function(e){return btoa(window[st0("1")](e.replace(/\"/g,"").replace(/,/g,"").slice(1,-1)))},h=function(e,t,n){return e&&t.forEach((function(o,i){-1==n.indexOf(i)&&o==e[1][i]&&(t[i]=-111111111)})),t},b=function(e){const t=e.auth;if(t.statux=1,e.DEVs.length>1&&e.mcc_statux.hasOwnProperty(e.DEVs[0])){const n=e.mcc_statux[e.DEVs[0]];t.sn=n[3],t.id=n[2],t.statux=n[1],t.token=e.DEVs[0],e.setAUTH(t)}},D=function(e){J.btnCANCEL[0].option("disabled",!0),J.btnOK.option("disabled",!0),clearTimeout(_.hwndTimeout),r.reject(),c.reject(),r=$.Deferred(),c=$.Deferred();const t=J.btnOK.__k,o=Math.random().toString(36).slice(2,10)+(new Date).getTime(),i=function(i,s,a){if(i[0][1]==s[1]&&-9999==s[1]){var r=[-1];switch(s[2]){case 1:N.find(".mt-3").html(a[6]);break;case 10001:r[0]=1,r[1]=JSON.parse(a[6]);break;case 50:r[0]=2,r[1]=a[6]}if(r[0]>-1&&(n.WDM[t[0]].wdms[z("serno","value")][r[0]]=r[1]),0==s[0])return clearTimeout(_.hwndTimeout),delete v[o],e?3:2}return 0},s=t&&t.length>2&&t[2].split("\n"),l=[1,-9999,JSON.stringify([(new Date).getTime()]),t[3],h(n.WDM[t[0]].wdms[z("serno","value")],[z("rtevt","value")?1:0,z("timezone","selectedItem").tim,z("timezone","value"),z("isatt","value")?1:0,0],[1,2])],d=["DeviceName"],u=function(){if(!a)if(s.length>0){var e=apisvr.a$.trim(s.shift());"~"==e.substring(0,1)?(k.WriteLn({type:"input",prompt:" ▲ ",value:e,typeDelay:10},(function(e){u()})),d.forEach((function(n){var o=e.split(n+"=");2==o.length&&"~"==o[0]&&(t[4][n]=o[1])}))):u()}else r.resolve("info")};v[o]=function(o,s,l){var d=0;if(0==l){var u=this;(t[1]==o[2]||e)&&(d=i(u,o[3],o[4]))}else d=1,a=!0,r.reject("info"),L(F[7][l],"text-danger",2,!0),J.btnOK.option("visible",!1);if(d>0){if(delete v[s],2==d)return c.resolve(o[5]),void b(n.WDM[t[0]]);3==d&&(r.resolve(""),c.resolve(o[5])),J.btnCANCEL[0].option("disabled",!1),J.btnOK.option("disabled",!1)}}.bind([l]),$.when(r,c).done((function(e,o){V.isSAVE=1,V.saveDB(n.WDM[t[0]].wdms,o),V.hide()})),r.promise(),c.promise(),_.hwndTimeout=setTimeout((function(){_.bind([null,3])()}),25e3),t[4]={},e?e(o):(n.WDM[t[0]].emit(n.___[1],[[t[1]],l]),u())},w=function(e,t,o,i){if(!e)return;const s=atob(e).split(String.fromCharCode(4)),a="localconn"!=s[s.length-1]?g(s[1]):(gloEVTs.giaidoan2_localDEV(1==t?"destroy":"disconn",[s[s.length-2],s[0],[,,["del",o,i[0]]]]),"return");if("return"==a)return"localconn";if(n.WDM[a]){var r=n.WDM[a].DEVs.indexOf(s[0]),c=["0","1"];if(1===t&&(n.WDM[a].wdms.hasOwnProperty(o)&&(c=[o,n.WDM[a].wdms[o][0]]),n.WDM[a].emit(n.___[2],[s[0],0,c]),console.log([s[0],0,c])),r>-1){var l=n.WDM[a].DEVs.splice(r,1);l.length>0&&(n.WDM[a].auth.sn!=o||n.WDM[a].auth.sn==o&&0!=n.WDM[a].auth.statux||s[0]!=n.WDM[a].auth.token)&&gloEVTs.dumeTHIETBI.f1.bind(["offline",l[0],,,["del"].concat(c)])()}0==n.WDM[a].DEVs.length?setTimeout((function(){n.WDM[a].off("disconnect").close([1]),delete n.WDM[a]}),1===t?1e3:1):1===t&&(n.WDM[a].auth={token:n.WDM[a].DEVs[0],statux:1})}},E=function(e){var o,i=e.length>4,s=i&&"wdmso"==e[4][0]?(o=e[4][4],e[4][3]):[];return"kickoff"==e[0]?n.fnHANDSHAKE([e[0],[e[1]],e[0],"0",s,o]):"usr"==e[0]?n.fnHANDSHAKE([e[0],[e[1]],e[0],e[3],s,o]):["online","offline"].indexOf(e[0])>-1?(n.fnHANDSHAKE(["sigLIVE",[e[1]],e[0],e[3],s,o],e),"cntU"!==e[3]&&gloEVTs.dumeTHIETBI.f1.bind(e)()):e[3]&&e[3]===n.___[0]&&t.trigger(e[3]+"S",[e[4].split("\t")]),i||s.length>0},C=function(){if(!this||!this[0])return;const e=this,t=atob(e[0]).split(String.fromCharCode(4)),o="localconn"!=t[t.length-1]?g(t[1]):("-9999"==e[5]?s(["kickoff"]):gloEVTs.giaidoan2_localDEV("connect",[[t[t.length-2],"0",e[2]],e[0],e[4],function(e){s&&"function"==typeof s&&s(["connect"])}]),"return"),a={token:t[0],statux:e[1],id:e[2],sn:e[3]},r=function(){n.WDM[o].on("connect",(function(e){if(s&&"function"==typeof s)s(["connect"]);else{n.WDM[o].auth;var t=n.WDM[o].sockAUT(),a=n.WDM[o].mcc_statux;n.WDM[o].DEVs.forEach((function(e){if(e!=t.token)for(var i in a)if(a.hasOwnProperty(i)){const t=a[i];e==t[0]&&n.WDM[o].emit(n.___[2],[e,1,1,t[2],t[3]])}}))}i>0&&p()})).on("connect_error",(function(e){console.log("connect_to_wdms_server connect_error");var t=!1,a=0,r="eeeeeeee",c=e.message&&e.message.split(r)||[];2==c.length&&""==c[0]&&"disconnect"==(r=JSON.parse(c[1]))[0]&&(a=r[1],c=r[2],t=!0),s&&"function"==typeof s&&s(["connect_error",t]),i>0&&(t?L(F[2][a],"text-danger",c):m(1)),n.WDM[o].DEVs&&"offline"!=n.fnHANDSHAKE.currMSG&&n.WDM[o].DEVs.forEach((function(e){n.fnHANDSHAKE(["sigLIVE",[e],"offline",0,[]])}))})).on("reconnect",(function(e){console.log("connect_to_wdms_server reconnect")})).on("disconnect",(function(e,t){console.log("connect_to_wdms_server disconnect"),n.WDM[o].DEVs&&n.WDM[o].DEVs.forEach((function(e){n.fnHANDSHAKE(["sigLIVE",[e],"offline",0,[]])}))})).on("DEV_MSG",(function(e){"RST_CMD"==e[0]?_.bind([e,e[1]])():(i>0&&("online"==e[0]?p():m(2)),"cntU"!==e[3]&&"DEV_JOIN_RMV"==e[0]&&(b(this),e[0]="online"),E(e)&&"wdmso"==e[4][0]&&(console.log("new wdmso"+(new Date).getTime()+JSON.stringify(e[4][3])),this.wdms[e[4][1]]=[e[4][2],e[4][3],e[4][4],e[4][5]]))}),"RTEVT").STARTd()};if("return"==o)return console.log(t[t.length-2]),[o,e[0]];const c=sockjo.getSOCK(o),l=c&&c.instance.DEVs.indexOf(t[0])>-1;if(!0===l&&n.hasOwnProperty("onlyDEV_ATT_EVT")||(n.WDM[o]=c),n.WDM[o]){if(!0===l&&n.hasOwnProperty("onlyDEV_ATT_EVT"));else{var d=!1;n.WDM[o].hasOwnProperty("instance")&&(n.WDM[o]=n.WDM[o].instance,r(),d=n.WDM[o].DEVs.indexOf(t[0])>-1),n.WDM[o].auth=a,n.WDM[o].emit(n.___[2],[t[0],1,e[1],e[2],e[3]]),d&&-1!=n.WDM[o].DEVs.indexOf(t[0])||n.WDM[o].DEVs.push(t[0])}s&&"function"==typeof s&&s([n.___[2]])}else{const e=JSON.parse(t[1]).reduce((function(e,t){return e+String.fromCharCode(parseInt(t,16))}),"");var u=window.location.protocol;u=u.indexOf("file:")>-1?1===window.debuglocal?"http:":"https:":u,n.WDM[o]=new JO(u+"//"+(u.indexOf("https")>-1?e.split(":")[0]:e),{auth:a,transports:["websocket","polling"]},[o]),r(),n.WDM[o].auth=a,n.WDM[o].DEVs=[t[0]]}return[o,t[0]]},O=function(e,t,n){if(o>0){clearTimeout(o);var i=e-parseInt(((new Date).getTime()-l.getTime())/1e3);e>0&&i<=0?X():(e>0?i+=t[0]:(i=Math.abs(i)+" seconds passed",n=t[Math.abs(e)],e-=1,Math.abs(e)>t.length-1&&(e=0)),k.WriteLn({type:"input",prompt:" ⏳ "+i,value:n,typeDelay:30},(function(i){-2!=o&&(o=setTimeout((function(){O(e,t,n)}),2e3))})))}},y=function(){U.empty(),clearTimeout(o),o=-2,U.removeClass("timeout")},T=function(e,t,o,i){n.WDM[e].DEVs.indexOf(t[0]);const s=Math.random().toString(36).slice(2,10)+(new Date).getTime(),a=setTimeout((function(){_.bind([[,,t[0]],3])()}),-505==o[1]?3e4:8e3);v[s]=function(t,o,s){const a=this,r=function(e){clearTimeout(a[2]),delete v[o]};a[1]==t[2]&&(0==s?0==t[3][0]?(r(),i("OK",t,o)):10001==t[3][2]&&n.WDM[e].wdms[doD.serno]&&(n.WDM[e].wdms[doD.serno][1]=JSON.parse(t[4][6])):(r(),"-505"!=a[0][1]&&toastMsg(F[8][3]+"("+s+")","error"),i("ERR",[,,,[0]],o)))}.bind([o,t[0],a]),n.WDM[e].emit(n.___[1],[[t[0]],o])},x=function(e,t){t=t.concat([e[2],e[3]]),e&&"function"==typeof e[4]?(t.push(e[5]),e[4](t)):($(e[0].target).trigger("rst_devstas",t),toastMsg(F[8][4],"success"))},S=n._cmddev=function(){const e=this,t=e[1],o=e[2].tok,i=[t,"RocX8fPu8CM6HymwUub1GmcFvvegwXZWz4CGeTJykziuiTC8P/bEhfjYbn4mjk+r5FIAhp5EsONgoKuUMlRd/Hii5dbxS/OkKuc3yHSeXb9UWSVin6FFhEe5y7U8UAiXma98+r/F7oDlH1EPgcP9wtokBMHbrbO/xofN6XZU12qm8ncMsaHhiw1hDI5ub4udUOkdpXLMqfuT1s6qVjMnNw==",e[5]||"0|100|0|$!N;$!N;$!N;|0|2",e[2].id],s=atob(o).split(String.fromCharCode(4)),a="localconn"!=s[s.length-1]?g(s[1]):(r=[[s[s.length-2]],o,i,function(t,n){x(e,[t,[n,,,["localconn",i[0],i[2]]]]),srclocked(!1)}],gloEVTs.giaidoan2_localDEV("devcmd",r),"return");var r;"return"!=a&&n.WDM[a]&&T(a,s,-505==t?(i.unshift(e[0]),i):[1,t,"tinhsau"],(function(t,n,o){try{0==n[3][0]&&x(e,[t,n])}catch(e){}finally{srclocked(!1)}}))};var M,k,N,V,W;const A=function(e,t){F.$regstep=e;const n=N.find(".wdms-regstep span.btn");for(var o=0;o<n.length;o++){var i=$(n[o]),s=i.next();if(s.removeAttr("class").html("<small>"+s.text()+"</small>"),o<=e)if(o<e)i.removeAttr("disabled").removeClass("btn-default btn-warning").addClass("btn-success"),i.text("✔"),s.text(s.text()),s.addClass("text-success");else{var a="btn-success";t>0&&(a="btn-warning",s.text(s.text()).addClass("text-warning")),i.removeAttr("disabled").removeClass("btn-default").addClass(a),N.find(".text_conn").text(s.text())}else i.attr("disabled","disabled").removeClass("btn-success").addClass("btn-default")}n.closest(".wdms-regstep").css("display","")},I=function(e,t,n){J.btnCANCEL[0].option({icon:J.btnCANCEL[e],text:J.btnCANCEL[t]}),J.btnCANCEL.act=n},L=function(e,t,n,o){(F[4][0]!=n||o)&&(F[4][0]=n,N.empty(),y(),N.append([U,$("<div>"+F[0].replace("$TIT$",F[4][n])+'<div class="mt-3 text-center"><i class="fa fa-quote-left" aria-hidden="true"></i> '+e+' <i class="fa fa-quote-right" aria-hidden="true"></div></div>')]),U.next().addClass(t),3==n?I(3,4,1):I(1,2,2))},P=function(){L(F[3],"text-success",3),y(),U.addClass("timeout"),o=1,l=new Date,O(120,[F[6][5]],F[6][6])},K=function(e){var t=/^(http|https):\/\/[^:\/]+(?::(\d+))?/,o=(e=W.getEditor("wdms").option("value")).match(t),s=document.createElement("a"),a=function(){return e=s.pathname.split("/"),{auth:{token:"token-secure-socket",ireg:{sn:z("serno","value"),pkey:z("pkey","value"),tz:z("timezone","selectedItem").tim,rtevt:z("rtevt","value")?1:0,grp:e[e.length-1],tep:0}},transports:["websocket","polling"]}};null===o&&(e=window.location.protocol.indexOf("file:")>-1&&1===window.debuglocal?window.location.protocol+"////"+e:window.location.protocol+"//"+e),s.href=e,n.socIO&&n.socIO.off();var r=s.protocol.indexOf("file:")>-1?"wss://":"";r=r+s.hostname+(""!=r||s.protocol.indexOf("https")>-1?":444":":11015"),1===window.debuglocal&&window.location.protocol.indexOf("file:")>-1&&(r="ws://"+W.getEditor("wdms").option("value").split(":")[0]+":11015"),n.socIO=io(r,a()),n.socIO.on("connect",(function(e){P()})).on("connect_error",(function(e){var t=0,n="eeeeeeee",o=e.message&&e.message.split(n)||[];2==o.length&&""==o[0]?"disconnect"==(n=JSON.parse(o[1]))[0]&&(t=n[1],o=n[2]):o=2,L(F[2][t],"text-danger",o)})).on("reconnect",(function(e){})).on("disconnect",(function(e,t){L(F[2][0],"text-danger",2),console.log("elUI.socIO.on('disconnect', (reason): "+e)})).on("reg_wdms",(function(e){if("begincmd"==(e=JSON.parse(e))[0])y(),k.WriteLn({type:"input",prompt:" ▲ ",value:"We are checking your WDMS device, please wait a moment ...",typeDelay:20},(function(t){if(0==F.$regstep){var n,o=$('<span class="progress"></span>');o.appendTo(U),n=o.innerWidth(),F.$pCHAR=[$('<span class="progress-bar" style="width:'+.2*n+'px; position: absolute; white-space: nowrap; transition: none 0s ease 0s;">20%</span>').appendTo(o),e[1],n]}})),A(0,0);else if("handshakecmd"==e[0]){var t=F.$pCHAR;if(t){var o=e[1]/t[1],s=parseInt(100*o),a=o*t[2];t[0].width(a>t[2]?t[2]:a).text((s>100?100:s)+"%")}}else if("handshakeend"==e[0])"CHK::OK"!=e[1]?(console.log("reg_check_err"),L(F[5][0],"text-danger",4),A(0,1)):(y(),k.WriteLn({type:"input",prompt:" ▲ ",value:F[5][1],typeDelay:20},(function(e){})),A(1,0));else if("activeend"==e[0])"WDMS::OK"!=e[1]?(console.log(e[1]),L(F[5][2]+e[1],"text-danger",4),A(1,1)):(y(),k.WriteLn({type:"input",prompt:" ▲ ",value:F[5][3],typeDelay:20},(function(e){})),A(2,0));else if("regresult"==e[0])if(""!=e[1]){this.auth.ireg.tep=-9999;var r=W.option("formData");r.tok=e[1],e[4]&&(r.fcmk=e[4]),m._lastMSG=-1,i=1,J.btnOK.__k=C.bind([e[1],0,r.id,r.serno,[Z(r)]])(),J.btnOK.__k.push(e[2]),J.btnOK.__k.push(e[3]),I(1,2,2),n.socIO.off("connect").off("disconnect").off("connect_error").off("reg_wdms")}else L(F[5][2],"text-danger",4),A(2,1);$(".sockmsg").text(e)}))},j=function(){N.html(""),W.option({readOnly:!1,disabled:!1}),J.btnWDMS.option("visible",!0),J.btnCLOSE.option("disabled",!1),J.btnCANCEL[0].option("disabled",!1),J.btnOK.option("disabled",!1),J.btnOK.option("visible",!1),J.btnOK.__k=null,W._$element.removeClass("opac2"),I(1,2,0),V.preventCANCEL_AGAIN=0,F[4][0]=0},R=function(e,t){n.dogTimezone[0].visible=!0;var o=!1;if(t>-1&&e)for(var i in n.WDM)if(n.WDM.hasOwnProperty(i)){var s=n.WDM[i].wdms;s.hasOwnProperty(e.serno)&&(o=!0,t=s[e.serno][1],e.rtevt=1==t[0],e.time_zone=t[1],e.timezone=t[2],e.isatt=1==t[3],2e3!=t[1]&&(n.dogTimezone[0].visible=!1))}o||(e.rtevt=!0,e.time_zone=2e3,e.timezone=2e3,e.isatt=!0),W&&z("timezone","dataSource",n.dogTimezone)},z=function(e,t,n){var o=W.getEditor(e);if(void 0===n)return o.option(t);o.option(t,n)},J={btnCANCEL:[null,"revert",n.lan.js_009_19||"Cancel","ti ti-unlink",n.lan.js_009_20||"Stop MOBI","tips","Hoan tat"]},U=$('<div class="more-link"></div>'),F=['<div class="wdms-regstep text-small" style="display:none;"><div> <span class="btn btn-sm btn-default">1</span><p><small>Check</small></p></div><div>     <span class="btn btn-sm btn-default">2</span>    <p><small>Active</small></p></div><div>    <span class="btn btn-sm btn-default">3</span>    <p><small>Online</small></p></div></div><div><div class="dog_canvas"></div><div class="box_conn"><div class="text_conn text-uppercase">$TIT$</div><div class="comp"></div><div class="loader_conn"></div><div class="con"></div><div class="byte"></div><div class="server"></div></div></div>',"Connect to Mobi service ...",["Connect error, please check WDMS or IP address and try again  ...","Token invalid for connection!","There is another Active your device."],(n.lan.js_009_21||"Please enter server Mobi into device")+'. <a href="javascript:void(0)">'+(n.lan.js_009_22||"Click here for a help")+" </a>",[0,"CONNECTING","ERROR","CONNECTED","UNSUPPORTED","INVALID","DUPLICATED"],["Sorry, our service have not yet support your device ...","Congratulation your device passed our check! Next step we establish WDMS cloud for your device, keep patient ....","Device actived error: ","Device try connecting to our WDMS server ..."],["Complete by click OK button",["Opps! Mobi service down...","Please check Device network connection...","Please check Device IP, DNS, Gateway...","... Try more please !"],["Humm! We are looking for your device...","Please check Device network connection...","Please check Device IP, DNS, Gateway..."],"<i>"+(n.lan.js_009_23||"Please confirm you want to skip MOBI activation")+" ?</i>","<i>"+(n.lan.js_009_24||"Please confirm that you want to remove the device")+" ?</i>"," seconds next expired","Is your device ready ...?"],["","Standalone command timeout","Can not find MOTER","Mobi service timeout","Can not find your Device"],n.lan.js_009_25||["<i>Please confirm save changes ?</i>","Opps! no changes for updating.","The device is offline, it can not be updated !","An error occurred during the update, please try again.","Update successful"]],H=$('<div class="fuck-title text-center text-uppercase ">Activate Mobi function</div>'),B=function(e,t){DevExpress.ui.dialog.confirm(e,null,!1).done((function(e){t(e)}))},G=function(e){var t,n=J.btnUPT.option("visible");["ten","serno","wdms","pkey"].indexOf(e.dataField)>-1&&(t=apisvr.a$.trim(e.value),e.component.getEditor(e.dataField).option({value:t})),n&&(J.btnUPT.option("disabled",!1),V._cpFieldChanged[0][e.dataField]=t||e.value),V.isSAVE=1};function X(e){y();var t=function(){o();var e=W.option("formData");w(e.tok,1,e.serno),!e.tok&&n.localDEV&&gloEVTs.elUI_localDEV("disconn",[e.wdms]),j(),V.preventCANCEL_AGAIN=1,V.hide()},o=function(){var e=0;return 0!=J.btnCANCEL.act&&n.socIO&&(n.socIO.close(),e=1),j(),1==e};e?J.btnOK.__k?J.btnOK.option("visible")?B(F[6][3],(function(e){e&&t()})):t():o()||(V.preventCANCEL_AGAIN=1,V.hide()):o()}function q(e,t,n){var o=W.getEditor(e),i=o.option("value"),s=o._$element.data("dxValidator"),a=s&&s._getValidationRules()[0],r=100;if(a)return n&&(null==i||""===apisvr.a$.trim(i.toString())?r=0:n.forEach((function(t){t[e]==i&&(r=1)}))),r<100?(a.message=t[r],a.isValid=!1,o.focus()):(a.message="",a.isValid=!0),s.validate(),r}function Z(e){return JSON.stringify([e.rtevt?1:0,e.time_zone,e.timezone,e.isatt?1:0,0])}const Q={seri:[_La$N("js_009_25|11",n.lan)||"Serial empty",_La$N("js_009_25|12",n.lan)||"Serial duplicated"],ip:[_La$N("js_009_25|13",n.lan)||"IP empty",_La$N("js_009_25|14",n.lan)||"IP duplicated"],id:[_La$N("js_009_25|15",n.lan)||"Id empty",_La$N("js_009_25|16",n.lan)||"Id duplicated"],ten:[_La$N("js_009_25|17",n.lan)||"Name empty",_La$N("js_009_25|18",n.lan)||"Name duplicated"]};function Y(e){var t=ne.kind,o=this[0],s=this[1];if(0==t[0]){if(q(t[1],Q.seri,o)<100)return}else q("wdms",Q.ip,o.filter((function(e){return e.kind==t[0]})));if(!(q("id",Q.id,o)<100||q("ten",Q.ten,o)<100)){var a=W.validate();a.isValid?(W.option("readOnly",!0),J.btnWDMS.option("visible",!1),J.btnCLOSE.option("disabled",!0),L(F[1],"",1),W._$element.addClass("opac2"),setTimeout((function(){var e=function(){const e=W.option("formData");if(101==s&&(a=gloEVTs.giaidoan2_localDEV("connect",[[e.wdms,"0",e.id],null,[Z(e),,e.pkey]])))return a;0==t[0]||101==s&&null==a?_gsC(sockjo.soclib,"js",(function(e){K()}),"socket.io.js"):(m._lastMSG=-1,i=1,J.btnOK.__k=C.bind(["STZSZE1FOFo4WmNUVXNId3RwaW5odUE5RlhFL0c1b2p1and6MDVsOHc2ZmJseWp0RFBOZzZHc2Rpb3E2ZWdGVWZWcXkzT2cvak9Eb3pOQ2JMelVKa0QwMitiejJqQS9YeXdZQ2dUN1JjOE09BFsiMzEiLCIzOSIsIjMyIiwiMmUiLCIzMSIsIjM2IiwiMzgiLCIyZSIsIjMxIiwiMmUiLCIzOSIsIjMxIiwiM2EiLCIzMyIsIjMwIiwiMzAiLCIzMCJd",1,0,0,[Z(e)]])(),J.btnOK.__k.push("msg[2]"),J.btnOK.__k.push("0"),I(1,2,0))};k?e():_gsC(srcpf$+"/media/js/termynal.js","js",(function(){k=new Termynal(U[0],{cbNewLine:function(){},lineDelay:5}),e()}),"TermynalJS")}),50)):toastMsg(_La$N("js_009_25|5",n.lan)||"Require to fill information","error",null,"top center")}}function ee(e,o){var s=this[0],a=this[1];if(i=0,1==V.isSAVE&&s&&"function"==typeof s){V.isSAVE=0;var r=W.option("formData"),c=[];if(r.time_zone=z("timezone","selectedItem").tim,r.wdmo=JSON.stringify([]),e){var l=z("serno","value");e.hasOwnProperty(l)&&(r.wdmo=JSON.stringify(e[l]),c=["wdmso",l,e[l][0],e[l][1],e[l][2]])}if(-1===a){var d=J.btnOK.__k,u=d[4],f=d[1],p=r.tok;for(var m in p||(r.tok=f,p=f),u)u.hasOwnProperty(m)&&r.hasOwnProperty(m)&&(r[m]=u[m]);s(r),t.find('.mcc-statux[tok="'+p+'"]').attr("tok",f).data(f,[f,1,r.id,r.serno]),0==r.kind&&(n.WDM[d[0]].mcc_statux[f]=[f,1,r.id,r.serno]),E(["online",f,[],o,c]),console.log("dosave")}else s(r,a);z.__doD=r,0==r.kind&&gloEVTs.elUI_localDEV&&gloEVTs.elUI_localDEV("fcmdev",[r,"3"])}}function te(){var e=function(){V.preventCANCEL_AGAIN=1,V.hide(),srclocked(!1)};if(1==V.isSAVE){var t=V._cpFieldChanged[1],o=V._cpFieldChanged[0],i=[];for(var s in o)o.hasOwnProperty(s)&&t.hasOwnProperty(s)&&o[s]!=t[s]&&i.push(s);if(i.length>0)return void B(F[8][0],(function(t){if(t){srclocked(!0),J.btnCLOSE.option("disabled",!0),J.btnCANCEL[0].option("disabled",!0),J.btnUPT.option("disabled",!0);var o=W.option("formData"),i=(o.time_zone=z("timezone","selectedItem").tim,o.tok),s=atob(i).split(String.fromCharCode(4)),a="localconn"!=s[s.length-1]?g(s[1]):(function(){const t=Z(o);gloEVTs.giaidoan2_localDEV("edit",[[s[s.length-2],"0",o.id],i,[t,,o.pkey],function(t,n){n||((n={})[o.serno]=JSON.parse(o.wdmo)),V.saveDB(n),toastMsg(F[8][4],"success"),e(),gloEVTs.giaidoan2_localDEV("fcmdev",[o,"33"])}])}(),"return");if("return"!=a)if(n.WDM[a]){n.WDM[a].DEVs.indexOf(s[0]);var r=Math.random().toString(36).slice(2,10)+(new Date).getTime(),c=function(){clearTimeout(_.hwndTimeout),delete v[r]},l=[1,-9998,h(n.WDM[a].wdms[z("serno","value")],[o.rtevt?1:0,o.time_zone,o.timezone,o.isatt?1:0,0],[])];v[r]=function(t,i,s){0==s?0==t[3][0]?(c(),toastMsg(F[8][4],"success"),V.saveDB(n.WDM[a].wdms),e()):10001==t[3][2]&&n.WDM[a].wdms[o.serno]&&(n.WDM[a].wdms[o.serno][1]=JSON.parse(t[4][6])):(c(),toastMsg(F[8][3]+"("+s+")","error"),e())}.bind([l]),_.hwndTimeout=setTimeout((function(){_.bind([null,3])()}),8e3),n.WDM[a].emit(n.___[1],[[s[0]],l])}else toastMsg(F[8][2],"error"),e()}}));toastMsg(F[8][1],"warning")}e()}const ne=function(e){return"serno"},oe=function(e){return"Serial number"},ie=function(e){return 0==e?"Mobi server":"IP Address"},se=function(e){return _La$N("js_009_18|"+(0==e?e:1),n.lan)||(0==e?"Start MOBI":"Connect")},ae=function(e){return 0==e?[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}},{type:"required"}]:[]};if(this._Device=function(e,o,i,s,a){M=null,R(e.dat,s);const r=function(e){const t=W.getEditor("txt1"),n=ne.kind?ne.kind[0]:a;t&&t._$element[("0"==n?"remove":"add")+"Class"]("d-none d-sm-block"),"-1"==s&&(t.option("value",""),W.getEditor("wdms").option("value","0"==n?"":"192.168.1.201")),J.btnWDMS&&J.btnWDMS._$element.find(".dx-icon").attr("class","dx-icon "+(101==n?"ti-plug":"dx-icon-globe")),srclocked(!1)},c=function(e){1!=V.preventCANCEL_AGAIN&&X(),window.cdv_jsex&&e.component._$popupContent.trigger("cdvHidden",[V])},l=function(e){setTimeout((function(){W.updateDimensions()}),200);const t=J.btnUPT.option("visible");W.getEditor("wdms").option("readOnly",t),W.getEditor("pkey").option("readOnly",t),W.getEditor("serno").option("readOnly",t),t||W.getEditor("timezone").option("value",2e3),M=G,window.cdv_jsex&&e.component._$popupContent.trigger("cdvShown",[V])};admin$.DEV((function(){setTimeout((function(){if(V){W.option("formData",e.dat),J.btnWDMS.option({onClick:Y.bind([i,a]),text:se(a)}),j(),J.btnUPT.option({visible:-1!==s,disabled:!0}),J.btnWDMS.option("visible",-1===s),q("id",Q.id,[]);var d=ne.kind;d[1]=ne(a),W.itemOption("txt1","dataField",d[1]),W.itemOption("txt1","label",{text:oe(a)}),W.itemOption("txt1","validationRules",ae(a)),W.itemOption("wdms","label",{text:ie(a)}),W.getEditor("txt1").option({disabled:0!=a}),d[0]=a,q(d[1],0==a?Q.seri:Q.ip,[]),ne.kind=d,V.option({onShowing:r,onHidden:c,onShown:l})}else V=$("<div></div>").appendTo(t.on("onRemoving",(function(e){V.dispose()}))).dxPopup({contentTemplate:function(t){return W=$("<div class='filter_fucking' style='min-height:50vh'></div>").appendTo(t).dxForm({labelMode:"floating",formData:e.dat,screenByWidth:function(e){return e<400?"xs":e<500?"sm":"md"},colCountByScreen:{md:4,sm:1},items:[{dataField:"wdms",colSpan:2,label:{text:ie(a)},validationRules:[{type:"required",message:_La$N("js_009_25|6",n.lan)||"Require to fill"}]},{name:"txt1",dataField:ne(a),colSpan:2,label:{text:oe(a)},editorOptions:{disabled:0!=a,onContentReady:function(e){J.txt1=e.component,ne.kind=[a,ne(a)]}},validationRules:ae(a)},{itemType:"group",colCountByScreen:{sm:4,xs:2},colSpan:4,colCount:4,items:[{dataField:"pkey",label:{text:"Mobi P-key"},validationRules:[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}}]},{dataField:"id",label:{text:"No."},validationRules:[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}}]},{dataField:"ten",colSpan:2,label:{text:n.lan.js_009_17||"Name"},editorOptions:{maxLength:15},validationRules:[{type:"custom",validationCallback:function(e){return!e.rule.hasOwnProperty("isValid")||e.rule.isValid}}]}]},{itemType:"group",caption:n.lan.js_009_4||"Advanced setting",cssClass:"advance-item",colCountByScreen:{md:4,sm:1},colSpan:4,colCount:4,items:[{dataField:"area",colSpan:2,editorOptions:{text:"(Default)",disabled:!0},label:{text:n.lan.js_009_8||"Area"}},{dataField:"timezone",colSpan:2,editorType:"dxSelectBox",editorOptions:{dataSource:n.dogTimezone,displayExpr:"dis",valueExpr:"id"},label:{text:n.lan.js_009_6||"Timezone"}}]},{itemType:"group",colCountByScreen:{sm:4,xs:1},colSpan:4,colCount:4,items:[{dataField:"isatt",colSpan:2,editorType:"dxCheckBox",label:{text:n.lan.js_009_7||"Attendance device"}},{dataField:"rtevt",colSpan:2,editorType:"dxCheckBox",label:{text:n.lan.js_009_5||"Realtime event"}}]}],readOnly:!1,showColonAfterLabel:!0,labelLocation:"left",minColWidth:300,colCount:4,onFieldDataChanged:function(e){M&&"function"==typeof M&&M(e)}}).dxForm("instance"),N=$("<div class='font-italic'></div>").appendTo(t),t},deferRendering:!1,width:"100%",maxWidth:600,height:"auto",fullScreen:"phone"==DevExpress.devices._realDevice.deviceType,showTitle:!0,visible:!1,dragEnabled:!1,showCloseButton:!0,animation:{show:{type:"pop"}},onHidden:c,onShowing:r,onShown:l,onContentReady:function(e){e.component._$wrapper.addClass("tbh-filter-popup keep-def containscroll caidat_push_device"+("phone"==DevExpress.devices._realDevice.deviceType?"":" caidat_push_device_overflow"));var t=e.component._$content;J.btnCLOSE=t.find(".dx-closebutton").dxButton("instance")},toolbarItems:[{html:H,location:"after"},{widget:"dxButton",location:"before",options:{icon:"help",type:"success",stylingMode:"text",onClick:function(e){}}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:J.btnCANCEL[1],elementAttr:{class:"show-orther-more"},text:J.btnCANCEL[2],stylingMode:"outlined",onContentReady:function(e){J.btnCANCEL[0]=e.component,J.btnCANCEL.act=0},onClick:X}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:"globe",elementAttr:{class:"show-orther-more"},text:se(a),type:"default",stylingMode:"outlined",visible:-1===s,onContentReady:function(e){J.btnWDMS=e.component},onClick:Y.bind([i,a])}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:"ti ti-save",text:"Save",type:"success",stylingMode:"outlined",visible:-1!==s,disabled:!0,onContentReady:function(e){J.btnUPT=e.component},onClick:te}},{widget:"dxButton",toolbar:"bottom",location:"center",options:{icon:"tips",type:"success",stylingMode:"outlined",text:"OK",visible:!1,onContentReady:function(e){J.btnOK=e.component},onClick:function(e){D()}}}]}).dxPopup("instance");H.html(e.txt),V._cpFieldChanged=[{},JSON.parse(JSON.stringify(e.dat))],V.isSAVE=0,V.show(),V.saveDB=ee.bind([o,s])}),10)}))},this._confirmDEL=function(e,t){admin$.DEV((function(){setTimeout((function(){B(F[6][4],(function(e){t(e,w)})),srclocked(!1)}),10)}))},this._cmddev=function(e,t,n,o,i,s,a,r){i?S.bind([e,t,n,o,i,s,a,r])():admin$.DEV(S.bind([e,t,n,o,i,s,a,r]))},this.wdms_conn=function(e,o,i){gloEVTs.devcnt=o.length;var a=o.length,r=0,c=t.find(".mcc-statux"),l=function(){if(r<a){s=function(e){s=null,"connect_error"==e[0]&&e[1]&&w(o[r].tok,0,""),r+=1,l()};const e=o[r],t=[e.tok,1,e.id,e.serno,[Z(e),,e.pkey],e.kind],i=C.bind(t)();i&&(t[0]=i[1],c.map((function(n,o){o.getAttribute("tok")===e.tok&&(o.setAttribute("tok",i[1]),$(o).data(i[1],t))})),n.onlyDEV_ATT_EVT&&n.onlyDEV_ATT_EVT.bind([i,e,t])(),0==e.kind&&(n.WDM[i[0]].mcc_statux[i[1]]=t))}};a>0&&l()},n.__.forEach((function(e){t.on(e,u[atob(e)])})),window.gloEVTs&&(!gloEVTs.giaidoan2||!gloEVTs.devcnt||0==gloEVTs.devcnt)){gloEVTs.giaidoan2_localDEV=function(){const e=w0w._cordovaNative,t=(new Date).getTime()+Math.random().toString(36).substring(7),o={};if(e){const i={},s=function(o,s){var a,r=[],c={SND_OK:function(e){},conn_err:function(e){L(F[2][e]?F[2][e]:F[2][0],"text-danger",2),delete i[c.IP],delete c.IP},connect:function(n){if(r=[],c.TOK||J.btnCANCEL[0].option("disabled",!1),"0"==n||n.indexOf("CONN_STA")>0&&n.indexOf("offline")>0)c.TOK||c.conn_err(n.split(String.fromCharCode(4))[2]);else{if(n=n.split(";"),!c.TOK){L(F[1],"text-success",3),z("serno","value",n[7]),r.push(n[6]),r.push(JSON.parse(n[4])),a=$.Deferred();var o=setTimeout((function(){a.reject(),c.conn_err(0)}),1e4);const e=btoa(n[7]+";"+n[6]),t=btoa([n[1],c.IP,"localconn"].join(String.fromCharCode(4)));k.WriteLn({type:"input",prompt:" ▲ ",value:"MAC: "+n[6],typeDelay:20},(function(e){k.WriteLn({type:"input",prompt:" ▲ ",value:"SN: "+n[7],typeDelay:20},(function(e){$.when(a).done((function(e){D((function(i){clearTimeout(o),e[5]=n[8],v[i](e,i,0),gloEVTs.giaidoan2_localDEV("fcmdev",[z.__doD,"33",c.IP]),c.TOK=t}))}))}))})),J.btnOK.__k=[e,t,n[7],"0"]}c.wdmso=["wdmso",n[7],n[6],JSON.parse(n[4]),"",n[5]],e.hieu_comjs(["ATT_DEV_CONN",c.IP,"0",l="conn_online",t,"conn_online=50","2","3"])}},online:function(e){if(0==(e=e.split(String.fromCharCode(31)))[1].indexOf("RTEVT_STA"))return e[0]="LOCAL_DEV_MSG",void E(e);if(0!=e[1].indexOf("USR_EYE"))if(0!=e[1].indexOf("ATT_LOG"))if(0!=e[1].indexOf("CONN_STA"))if((e=e[1].split(String.fromCharCode(4)))[1]=e[6].split("=")[1],c.TOK)c.wdmso[4]=e[1],s=["online",c.TOK,[],50,c.wdmso],E(s);else{r[2]=e[1];var t=J.btnOK.__k;(d={})[t[2]]=r,n.WDM[t[0]]={wdms:d};var o=[,,,[0,-9999,50],[,,,,,,r[2],,],1];c.IP&&a.resolve(o)}else{var i=e[1].split(String.fromCharCode(4));i.shift();var s=i[1].split(";");if(i[1]=c.TOK?c.TOK:btoa([s[1],c.IP,"localconn"].join(String.fromCharCode(4))),i.push([]),i.push(0),s.length>4&&(i[3]=s[8],i.push(["wdmso",s[7],s[6],JSON.parse(s[4]),s[5]])),["reconnect","edit"].indexOf(l)>-1){var d;if(s.length>4){d={};const e=btoa(s[7]+";"+s[6]);d[s[7]]=[s[6],JSON.parse(s[4]),s[5]],n.WDM[e]={wdms:d}}c.cb&&(c.cb("OK",d),delete c.cb),-1==["offline","kickoff"].indexOf(i[0])&&(l="online",i[0]=l)}E(i)}else c.cb&&(c.cb("OK",e[1].split(String.fromCharCode(4))[1]),delete c.cb);else E(["usr",c.TOK,[],e[1].split(String.fromCharCode(4))[1]])},devcmd:function(e){l="online";var t="OK";if((e=e.split(String.fromCharCode(4)))[1].indexOf("offline")>-1)t="ERR";else{if(e[0].indexOf("ATT_LOG")>-1)return void(c.cb&&(c.cb(t,e[1]),delete c.cb));e[6]=e[6].split("=")[1]}c.cb&&(c.cb(t,[,,,,e]),delete c.cb)}},l="",d=function(n,o){const i=n[0],s=n[2]||[],a=function(e){return s[e]&&s[e].toString()||""};c.IP=i[0],c.TOK=n[1],n[3]&&(c.cb=n[3]),e.hieu_comjs(["ATT_DEV_CONN",i[0],i[1]?i[1]:"0",l=o||(c.TOK?"reconnect":"connect"),t,a(0),a(1),a(2),a(3),a(4),a(5),"",(i[2]||"").toString()])};c.conn_online=c.online,c.reconnect=c.online,c.edit=c.online,d(o,s),this.rst=function(e,t){"SND_OK"==e?c[e](t):t?d(e,t):c[l](e)}};$.extend(o,{connect:function(e){e[1]||J.btnCANCEL[0].option("disabled",!0),i[e[0][0]]=new s(e)},disconn:function(n){n.length>2&&gloEVTs.dumeTHIETBI.f1.bind(["offline",n[1]].concat(n[2]))(),e.hieu_comjs(["ATT_DEV_CONN",n[0],"0","disconn",t,"1","2","3"]),delete i[n[0]]},devcmd:function(e){i[e[0][0]].rst(e,"devcmd")},edit:function(e){i[e[0][0]].rst(e,"edit")},destroy:function(n){e.hieu_comjs(["ATT_DEV_CONN",n[0],"0","destroy",t,"1","2","3"])},fcmdev:function(n){var o=n.splice(0,1),i=JSON.parse(o[0].wdmo),s=o[0].fcmk||"",a="0"==n[0]?n[2]||"2":"tinydb",r="0"==i[1][0]||"0"==i[1][3]?"1":n[0];e.hieu_comjs(["ATT_DEV_CONN",s,r,"fcmdev",t,n[1]||"1",a,n[3]||"3",n[4]||"4",n[5]||"5",n[6]||"6",n[7]||"7",n[8]||"8",n[9]||"9",n[10]||"10"])}}),w0w.dopostqueue[t]=function(e){e=e.split(String.fromCharCode(3)),i.hasOwnProperty(e[0])&&("SND_OK"==e[1]?i[e[0]].rst(e[1],e[2]):i[e[0]].rst(e[1]))}}return gloEVTs.elUI_localDEV=function(e,t){if(o.hasOwnProperty(e))return o[e](t)}}();const e=function(t){var n=$.Deferred();return e.raw?n.resolve():(t.trigger("get",[srcp$f+"/media/utils/device_step2.html"+src$id,function(o){var i=this;t.trigger("",[o,!1,$.Deferred().done((function(){const t=$(adCS(arguments[0],i));for(var o=t.length-1;o>-1;o--)if(t[o].classList&&t[o].classList.contains("device-page__content")){e.raw=t[o].outerHTML;break}apisvr.a$.scod(arguments[3].splice(0,1)[0]),e.wokJS=arguments[3],e.wokJS.unshift("_$_ATTLOG_$_".hexEncode()),n.resolve()}))])}]),n)};DEVI__Q.VER[1]=d,gloEVTs.giaidoan2=function(t,o,i,s){const a=function(t){e(i).done((function(s){const a=$(e.raw).on("buoc2_c$b",gloEVTs.cb$STEP2),l=(["JS_JS_payrollonline","attlog_oneday"].indexOf(o)>-1?i:c.find(".modal-body")).append(a).ready((function(t){w0w._cordovaNative&&l.addClass("client_dienthoai"),Main.hasOwnProperty("device_step2")&&(gloEVTs.giaidoan2.fnXX=new Main.device_step2({el:l,elUI:n,wokJS:e.wokJS,zkblob:r}),gloEVTs.giaidoan2.fnXX.initWOK(i.__dbDAT.filter((function(e){return!0===e.isatt}))))})).on("DOWN_ATTLOG_END",(function(){console.log("DOWN_ATTLOG_END ",(new Date).getTime()),t()}));i$Desk&&["JS_JS_payrollonline","attlog_oneday"].indexOf(o)<0&&(c.log_scrollPerfect||(c.att_scrollPerfect=new PerfectScrollbar(l[0],{suppressScrollX:!0})))}))},r=function(e,t,o,i,s){setTimeout((function(){n[atob("X2NtZGRldg")].bind([s,e,t,o,a,i])()}),100);const a=function(e){const t=e[4].split("|");toastMsg(e[2].ten+" get block "+t[4]+" ~ "+(parseInt(t[1])+parseInt(t[4])),"OK"==e[0]?"success":"error",null,null,"fogetdev"),gloEVTs.giaidoan2.fnXX.bz2(e,r)};console.log("ios",s)};if(["JS_JS_payrollonline","attlog_oneday"].indexOf(o)>-1)return void DEVI__Q(a);const c=admin$.popup.bind().apply(null,[{a:"d",t:o,cBu:1,fw:0,cbClosed:function(e){c.att_scrollPerfect&&c.att_scrollPerfect.destroy(),n.unFixW&&n.unFixW()}}]),l=c.find("#popupdone");return c.find(".modal-dialog").addClass("modal-dialog-centered modal-dialog-zoom pu_fullW my-0").css({"max-width":"800px"}),c.find(".modal-footer").remove(),l.remove(),c[s||"one"]("shown.bs.modal",(function(){DEVI__Q(a)})),setTimeout(DEVI__Q((function(e){c.modal("show"),e()})),1),c}}}return t.prototype.publicSharedVar="quux",t.prototype.publicSharedMethod=function(e){},t}());