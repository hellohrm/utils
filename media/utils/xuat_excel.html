<div>
    <style type="text/css">
        .progress_exp_excel:before {
            content: "";
            background-position: center;
            background-size: cover;
            height: 100px;
            width: 250px;
            position: absolute;
            background: rgba(191, 191, 191, 1);
            /* top: 0; */
            z-index: -1;
            opacity: 0.5;
            transform: translate(-50%, -65%);
            left: 50%;
            border-radius: 10px;
        }
    </style>

    <section fuck_tmpl style="display:none">
        <div exp_excel class="progress " style="width: 200px;transform: translateX(-50%);left: 50%;position: absolute;height: 6px;">
            <div class="progress-bar" style="width:0%"></div>
        </div>
    </section>


</div>

<script type="text/javascript">
Main.exelEngine=function(){const e={excel_tmp:function(e){const t=$.Deferred();new XMLHttpRequest;return $.ajax({cache:!1,url:e,method:"GET",xhrFields:{responseType:"blob"},error:function(e,s,n){t.reject(e.responseText)},success:function(e){t.resolve(e)}}),t.promise()},more_LIBs:function(){const e=$.Deferred();return _gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-print@18.2.0/dist/gc.spread.sheets.print.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-io@18.2.0/dist/gc.spread.sheets.io.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-shapes@18.2.0/dist/gc.spread.sheets.shapes.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-charts@18.2.0/dist/gc.spread.sheets.charts.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-slicers@18.2.0/dist/gc.spread.sheets.slicers.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-pivot-addon@18.2.0/dist/gc.spread.pivot.pivottables.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-reportsheet-addon@18.2.0/dist/gc.spread.report.reportsheet.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-tablesheet@18.2.0/dist/gc.spread.sheets.tablesheet.min.js","js",function(){_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-ganttsheet@18.2.0/dist/gc.spread.sheets.ganttsheet.min.js","js",function(){e.resolve()},"gc.spread.sheets.ganttsheet.min.js")},"gc.spread.sheets.tablesheet.min.js")},"gc.spread.report.reportsheet.min.js")},"gc.spread.pivot.pivottables.min.js")},"gc.spread.sheets.slicers.min.js")},"gc.spread.sheets.charts.min.js")},"gc.spread.sheets.shapes.min.js")},"gc.spread.sheets.io.min.js")},"gc.spread.sheets.print.min.js"),e.promise()},excel_lib:function(t){const s=$.Deferred();Main.spread&&s.resolve("excel_lib");const n=function(){_gsC("/000webhostapp.tep/spreadjs_excel/gc.spread.sheets.all.18.2.0.min.js","js",function(){_gsC(srcpf$+"/media/vendor/jsexcel/gc.license.js","js",function(){Main.spread||(Main.spread=_geC(null,{calcOnDemand:!0})),e.ctrl[0].attr("taiing","Lib core ..."),_gsC(srcpf$+"/media/vendor/jsexcel/gc.FileSaver.js","js",function(){},"gc.FileSaver.js"),e.more_LIBs().done(function(){"11"==GetIEVersion()?_gsC("https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.10.4/polyfill.min.js","js",function(){s.resolve("excel_lib")},"polyfill.min.js"):s.resolve("excel_lib")})},"gc.license.js"),_gsC("https://cdn.jsdelivr.net/npm/@grapecity/spread-sheets-shapes@18.2.0/dist/gc.spread.sheets.shapes.min.js","js",function(){e.ctrl[0].attr("taiing","Lib shapes ...")},"gc.spread.sheets.shapes.min.js")},"gc.spread.sheets.all.min.js")};return t?_gsC("https://developer.mescius.com/spreadjs/demos/en/purejs/node_modules/@mescius/spread-sheets/styles/gc.spread.sheets.excel2013white.css","css",n,"gc.spread.sheets.excel2013white.css"):n(),s.promise()},excel_io:function(t){const s=$.Deferred();return _gsC(srcpf$+"/media/vendor/jsexcel/gc.FileSaver.js","js",function(){e.ctrl[0].attr("taiing","Lib FileSaver ..."),Main.excelIo&&s.resolve("excel_io"),_gsC("/000webhostapp.tep/spreadjs_excel/gc.spread.excelio.18.2.0.min.js","js",function(){e.ctrl[0].attr("taiing","Lib IO ..."),Main.excelIo||(Main.excelIo=new GC.Spread.Excel.IO),setTimeout(function(){s.resolve("excel_io")},300)},"gc.spread.excelio.min.js")},"gc.FileSaver.js"),s.promise()},expr_device_usr:function(t,s,n,r){const i=$.Deferred();sheet=Main.spread.getActiveSheet(),sheet.deleteRows(0,2),sheet.deleteColumns(9,2),sheet.deleteColumns(4,4),sheet.addColumns(4,3);const a=sheet.getUsedRange(GC.Spread.Sheets.UsedRangeType.all),o=a.colCount;sheet.copyTo(0,1,0,4,a.rowCount,3,GC.Spread.Sheets.CopyToOptions.all),a.rowCount>3&&sheet.deleteRows(3,a.rowCount-3),sheet.setColumnWidth(4,100),sheet.setColumnWidth(5,100),sheet.setColumnWidth(6,100);for(var c=0;c<s.length;c++)sheet.setValue(0,c,(c>0?s.eq(c).find("[data-lang]"):s.eq(c)).text());sheet.clear(1,0,2,o,GC.Spread.Sheets.SheetArea.viewport,GC.Spread.Sheets.StorageType.data),sheet.addRows(3,t.length);var d=0;const p=t.length>100?Math.ceil(t.length/100):1,l=function(){const s=d*p,a=s+p,c=a<t.length?a:t.length;if(r.css("width",100*c/t.length+"%"),s>t.length)return sheet.deleteRows(1,2),i.resolve();for(var h=s;h<c;h++)e.ctrl[0].attr("taiing",h+1+" / "+t.length),sheet.copyTo(2,0,3+h,0,1,o,GC.Spread.Sheets.CopyToOptions.all),sheet.setValue(3+h,0,parseInt(t[h][2])),sheet.setValue(3+h,1,n[t[h][0]][1]),sheet.setValue(3+h,2,t[h][4]),sheet.setValue(3+h,3,parseInt(t[h][9])),sheet.setValue(3+h,4,parseInt(t[h][10])),sheet.setValue(3+h,5,t[h][5]),sheet.setValue(3+h,6,t[h][7]),sheet.setValue(3+h,7,"14"==t[h][3]?"Admin":"");d+=1,window.requestAnimationFrame(l)};return l(),i.promise()},att_xls:{hed_dat:function(e){var t=$.Deferred();return e.svrDAT({uri:"/api/headermaster",act:"GET",qry:"jdat"}).done(function(e){t.resolve(e)}),t.promise()},emp_dat:function(e){var t=$.Deferred();return e.svrDAT({uri:"/api/empprofile",act:"SEL",qry:["acno","empcode","ho","ten","birthday","hireday","gender","offdate","secid","posid"]}).then(function(e){t.resolve(e)},function(e){t.resolve([])}),t.promise()},sht_Emp:function(e,t,s){const n=s[0].length;e.setRowCount(n+2,GC.Spread.Sheets.SheetArea.viewport);const r=[],i=t.secs.reduce(function(e,t){return e[t.id.toString()]=t.dis,e},{}),a=t.poss.reduce(function(e,t){return e[t.id.toString()]=t.dis,e},{});for(var o=0;o<n;o++){const e=s[0][o];e.acno,r.push([o+1,e.acno,e.empcode,e.ho,e.ten,t.gender[e.gender].dis,new Date(e.birthday).toLocaleDateString(),i[e.secid.toString()]?i[e.secid.toString()]:"",a[e.posid.toString()]?a[e.posid.toString()]:"",e.hireday?new Date(e.hireday).toLocaleDateString():"",e.offdate?new Date(e.offdate).toLocaleDateString():""])}e.setArray(2,0,r,!1)},time_io:function(t,s,n){const r=$.Deferred(),i=["Employees","Time_IO"];t.options.allowDynamicArray=!0;for(var a=t.getSheetCount()-1;a>-1;a--)-1==i.indexOf(t.getSheet(a).name())&&t.removeSheet(a);t.getSheetFromName("Attendance");return e.att_xls.sht_Emp(t.getSheetFromName(i[0]),s,n),r.resolve(-1),r.promise()},export_hsnv_xls:function(t,s,n){const r=$.Deferred(),i=["Employees"];for(var a=t.getSheetCount()-1;a>-1;a--)-1==i.indexOf(t.getSheet(a).name())&&t.removeSheet(a);return e.att_xls.sht_Emp(t.getSheetFromName(i[0]),s,n),r.resolve("save_2_file"),r.promise()},hr_dashboard_excel:function(e,t,s,n){if(n.hasOwnProperty("c0d")){const e={},t={};xemmau_js_hwnd[n.c0d](e,t)}if(e.Ti)return $.Deferred().resolve();{const e=$.Deferred();return e.resolve("save_2_file"),e.promise()}},rpt_timekeeper:function(t,s,n,r){return e.att_xls.hr_dashboard_excel(t,s,n,r)}},nhap_xuat_att_logs:function(e,t){}};function t(t){0;this.publicInstanceVar="baz",this.publicInstanceMethod=function(){},e.ctrl=[helloguy.find(".dx-loadindicator-wrapper").addClass("taii").attr("taiing","Loading ...")],$.when(e.excel_lib(t.renderEL),e.excel_tmp(t.tmpl)).done(function(s,n,r){const i=e.ctrl[0].next().addClass("progress_exp_excel").html($(Main.expr_exel_tmpl).find("section[fuck_tmpl]").html()).find(".progress-bar");t.args.push(i);var a=new GC.Spread.Sheets.Workbook(t.renderEL,{sheetCount:0});const o=GC.Spread.Sheets.FileType.excel,c=gQRY(t.tmpl);a.suspendPaint(),a.import(n,function(){if(c.hasOwnProperty("c0d")){const e=((s=(s=t.tmpl).substring(s.lastIndexOf("/")+1)).match(/[^.]+(\.[^?#]+)?/)||[])[0]+"|"+n.size,r=a.getSheet(0).getRange(c.c0d,GC.Spread.Sheets.SheetArea.viewport);xemmau_js_hwnd.hasOwnProperty(e)||(xemmau_js_hwnd[e]=Function("'use strict';return "+a.getSheet(0).getValue(r.row,r.col))()),a.getSheet(0).setValue(r.row,r.col,""),c.c0d=e}var s;GC.Spread.Common.CultureManager.culture(apisvr.a$.selected_language),$.when(e.att_xls.hed_dat(t.cb("$mainO")),e.att_xls.emp_dat(t.cb("$mainO"))).done(function(s,n){e.att_xls[t.job](a,s,n,c).done(function(s){a.resumePaint(),t.cb(s,a),e.ctrl[0].removeClass("taii").removeAttr("taiing"),i.parent().parent().removeClass("progress_exp_excel"),i.parent().remove()})})},function(){t.cb(-1),a.resumePaint()},{fileType:o,excelFileType:"XLSM",includeUnusedStyles:!0,lazyLoad:!0})}).fail(function(e,t){srclocked(!1)})}return t.prototype.publicSharedVar="quux",t.prototype.publicSharedMethod=function(e){},t}();
</script>